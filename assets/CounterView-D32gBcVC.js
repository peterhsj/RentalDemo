import{h as o,H as J,a5 as r,ac as z,a7 as d,n as e,ad as a,v as c,V as $,a2 as X,a6 as b,af as C,u as T,Z as g,F as Y,ae as ee,a0 as te,P as ae,Q as le}from"./vue-core-BOLQPpeJ.js";import{_ as Q,a as ne,c as oe}from"./PromptDialog-D32_C5pB.js";import{f as se,i as re,e as ue}from"./date-DE_Uv9Lq.js";import{_ as ie}from"./index-DvawD57X.js";import"./vuetify-B9nufYXq.js";const O=D=>{if(!D)return"";const h=new Date(D);return se(h,"yyyy-MM-dd")},ce={id:"checkin",class:"h-100"},de={class:"ml-3 text-h6 font-weight-bold text-grey-darken-2"},me={class:"d-flex flex-wrap justify-end w-100"},fe={class:"d-flex justify-space-between w-100"},ve={class:"mt-3 d-flex flex-wrap justify-end w-100"},H={__name:"CheckinForm",props:{activeTab:{type:Object,default:()=>({})}},emits:["closeForm"],setup(D,{emit:h}){const n=D,w=h,m=o(!1),f=o(""),k=o(""),V=o(!1),u=o({startDate:"",endDate:"",carNumber:"",phoneNumber:""}),I=o(null),N=o(),x=o({phoneRules:[t=>!!t||"手機號碼為必填",t=>/^\d{10}$/.test(t)||"請輸入有效的手機號碼"],carRules:[t=>!!t||"車號為必填"],startDateRule:[t=>!!t||"請選擇起始日期",t=>{if(!t||!u.value.endDate)return!0;const l=new Date(t),_=new Date(u.value.endDate);return!l||!_?!0:!ue(l,_)||"起始日期不能晚於結束日期"}],endDateRule:[t=>!!t||"請選擇結束日期",t=>{if(!t||!u.value.startDate)return!0;const l=new Date(u.value.startDate),_=new Date(t);return!l||!_?!0:!re(_,l)||"結束日期不能早於起始日期"}]}),F=o([{id:"p01",phoneNumber:"",carNumber:"ABC-1234",startDate:"2025-10-01",endDate:"2025-10-01"},{id:"p02",phoneNumber:"",carNumber:"DEF-1234",startDate:"2025-10-01",endDate:"2025-10-01"},{id:"p01",phoneNumber:"0912345678",carNumber:"",startDate:"2025-10-01",endDate:"2025-10-01"},{id:"p02",phoneNumber:"0987654321",carNumber:"",startDate:"2025-10-01",endDate:"2025-10-01"}]),v=o([]),R=()=>{n.activeTab.value==="selfCheckIn"?v.value=F.value.filter(t=>t.phoneNumber!==""):n.activeTab.value==="counterCheckIn"&&(v.value=F.value.filter(t=>t.carNumber!==""))};J(()=>{R()});const i=async()=>{const{valid:t}=await N.value.validate();if(!t)return;const{carNumber:l,startDate:_,endDate:E}=u.value;m.value=!0,f.value="無法登記",k.value="本車號已登記，須先刪除原本登記日期後才能再次申請。",V.value=!1},L=t=>{I.value=t,m.value=!0,n.activeTab.value==="counterCheckIn"&&(f.value="刪除登記車號",k.value=`確認刪除 ${t.carNumber} 申請車號？`),n.activeTab.value==="selfCheckIn"&&(f.value="刪除登記手機號碼",k.value=`確認刪除 ${t.phoneNumber} 申請手機號碼？`),V.value=!0},P=()=>{const t=v.value.findIndex(l=>l.id===I.value.id);t!==-1&&v.value.splice(t,1)},B=()=>{w("closeForm")},y=()=>{m.value=!1,P()},U=()=>{m.value=!1};return(t,l)=>{const _=r("v-icon"),E=r("v-avatar"),q=r("v-text-field"),p=r("v-col"),A=r("v-date-input"),j=r("v-btn"),M=r("v-row"),W=r("v-form"),Z=r("v-list-item"),G=r("v-list"),S=r("v-card"),K=r("v-container");return d(),z("div",ce,[e(S,{variant:"outlined",class:"rounded-lg bordered border-md bg-white h-100"},{default:a(()=>[c("div",{class:"px-4 py-3 d-flex align-center bg-orange-lighten-5 rental__header",onClick:B},[e(_,{icon:"fa:fas fa-chevron-left",size:"20",color:"grey-darken-1",class:"mr-2"}),e(E,{image:n.activeTab.icon,size:"40"},null,8,["image"]),c("span",de,$(n.activeTab.title),1)]),e(K,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:a(()=>[e(W,{ref_key:"checkinFormRef",ref:N,onSubmit:X(i,["prevent"])},{default:a(()=>[e(M,{dense:"",class:"flex-0-1"},{default:a(()=>[n.activeTab.value==="selfCheckIn"?(d(),b(p,{key:0,cols:"12",md:"4"},{default:a(()=>[e(q,{modelValue:u.value.phoneNumber,"onUpdate:modelValue":l[0]||(l[0]=s=>u.value.phoneNumber=s),placeholder:"請輸入登記手機號碼",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2",rules:x.value.phoneRules,required:""},null,8,["modelValue","rules"])]),_:1})):C("",!0),n.activeTab.value==="counterCheckIn"?(d(),b(p,{key:1,cols:"12",md:"4"},{default:a(()=>[e(q,{modelValue:u.value.carNumber,"onUpdate:modelValue":l[1]||(l[1]=s=>u.value.carNumber=s),rules:x.value.carRules,placeholder:"請輸入車號",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules"])]),_:1})):C("",!0),e(p,{cols:"12",md:"4"},{default:a(()=>[e(A,{modelValue:u.value.startDate,"onUpdate:modelValue":l[2]||(l[2]=s=>u.value.startDate=s),rules:x.value.startDateRule,"display-format":T(O),"prepend-icon":"","append-inner-icon":"fa:far fa-calendar-alt",placeholder:"起：2025-10-01",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules","display-format"])]),_:1}),e(p,{cols:"12",md:"4"},{default:a(()=>[e(A,{modelValue:u.value.endDate,"onUpdate:modelValue":l[3]||(l[3]=s=>u.value.endDate=s),rules:x.value.endDateRule,"display-format":T(O),"prepend-icon":"","append-inner-icon":"fa:far fa-calendar-alt",placeholder:"迄：2025-10-01",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules","display-format"])]),_:1}),e(p,{cols:"12"},{default:a(()=>[c("div",me,[e(j,{type:"submit",color:"light-green-darken-2",variant:"flat",class:"px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40"},{default:a(()=>[...l[5]||(l[5]=[g(" 登記 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},512),e(S,{variant:"outlined",class:"mt-5 pa-2 rounded-lg bordered border-md bg-white flex-grow-1 overflow-y-auto"},{default:a(()=>[e(G,null,{default:a(()=>[(d(!0),z(Y,null,ee(v.value,(s,be)=>(d(),b(Z,{class:"py-2",key:s.id},{default:a(()=>[c("div",fe,[e(M,{"no-gutters":"",class:"flex-grow-1"},{default:a(()=>[e(p,{cols:"12",md:"4",class:"text-h5 font-weight-bold text-grey-darken-1"},{default:a(()=>[g($(n.activeTab.value==="counterCheckIn"?s.carNumber:s.phoneNumber),1)]),_:2},1024),e(p,{cols:"12",md:"4",class:"rental-subtitle-1 text-blue-darken-3"},{default:a(()=>[g($(s.startDate),1)]),_:2},1024),e(p,{cols:"12",md:"4",class:"rental-subtitle-1 text-blue-darken-3"},{default:a(()=>[g($(s.endDate),1)]),_:2},1024)]),_:2},1024),c("div",null,[e(j,{density:"comfortable",variant:"flat",icon:"fa:fas fa-times-circle",class:"text-red-darken-1",onClick:he=>L(s)},null,8,["onClick"])])])]),_:2},1024))),128))]),_:1})]),_:1}),e(M,{"no-gutters":"",class:"flex-0-1"},{default:a(()=>[e(p,{cols:"12"},{default:a(()=>[c("div",ve,[e(j,{color:"blue-darken-3",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:B},{default:a(()=>[...l[6]||(l[6]=[g(" 完成離開 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),e(Q,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=s=>m.value=s),message:k.value,messageTitle:f.value,isConfirmBtn:V.value,onPromptConfirm:y,onOnClose:U},null,8,["modelValue","message","messageTitle","isConfirmBtn"])])}}},pe={id:"parkingView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},_e={class:"pt-2 d-flex align-center"},ge={__name:"CounterView",setup(D){const h="https://peterhsj.github.io/RentalDemo",n=o({}),w=o(!1),m=o(!1),f=o(!1),k=o(""),V=o(""),u=o(!1),I=R=>{n.value=R,w.value=!0,console.log("tab",n)},N=()=>{n.value={},console.log("close form",n.value),w.value=!1},x=()=>{f.value=!1,isInfo.value=!0,infoStatus.value="success",initForm()},F=()=>{f.value=!1},v=()=>{m.value=window.innerWidth<=960};return J(()=>{v(),window.addEventListener("resize",v)}),te(()=>{window.removeEventListener("resize",v)}),(R,i)=>{const L=r("v-img"),P=r("v-avatar"),B=r("v-card"),y=r("v-container");return d(),z("div",pe,[ae(e(y,{class:"pb-1 rental rental__wrapper"},{default:a(()=>[e(B,{variant:"elevated",elevation:"4",class:"pa-2"},{default:a(()=>[e(L,{color:"surface-variant",height:"200",width:"100%",src:`${T(h)}/images/hotel_01.png`,cover:"",alt:"Parking Image"},{default:a(()=>[...i[1]||(i[1]=[c("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},[g("住宿車輛"),c("br"),g("預約及臨櫃登記")],-1)])]),_:1},8,["src"]),c("div",_e,[e(P,{image:`${T(h)}/images/profile.svg`,size:"30"},null,8,["image"]),i[2]||(i[2]=c("span",{class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"}," John Doe 您好！ ",-1))])]),_:1}),w.value?C("",!0):(d(),b(ne,{key:0,tabList:T(oe),onSetActiveTab:I},null,8,["tabList"]))]),_:1},512),[[le,!m.value||!w.value]]),n.value.value==="counterCheckIn"?(d(),b(y,{key:0,id:"counterCheckIn",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:a(()=>[e(H,{ref:"searchFormRef",activeTab:n.value,onCloseForm:N},null,8,["activeTab"])]),_:1})):C("",!0),n.value.value==="selfCheckIn"?(d(),b(y,{key:1,id:"selfCheckIn",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:a(()=>[e(H,{ref:"searchFormRef",activeTab:n.value,onCloseForm:N},null,8,["activeTab"])]),_:1})):C("",!0),n.value.value==="parkingInfo"?(d(),b(y,{key:2,id:"parkingInfo",class:"rental rental__wrapper"},{default:a(()=>[...i[3]||(i[3]=[g(" parkingInfo ",-1)])]),_:1})):C("",!0),e(Q,{modelValue:f.value,"onUpdate:modelValue":i[0]||(i[0]=U=>f.value=U),message:V.value,messageTitle:k.value,isConfirmBtn:u.value,onPromptConfirm:x,onOnClose:F},null,8,["modelValue","message","messageTitle","isConfirmBtn"])])}}},De=ie(ge,[["__scopeId","data-v-6d27bf7e"]]);export{De as default};
