import{_ as ee,a as J}from"./index-BZ5mpnr8.js";import{f as X,_ as re,a as ie}from"./Logout.vue_vue_type_script_setup_true_lang-BvYwk3RJ.js";import{l as te,a7 as ue,ad as P,aa as r,n as e,ab as t,v as n,u as T,Y as c,a9 as C,af as R,k as s,a5 as de,a0 as D,F as W,ae as K,H as ae,ag as ce,a3 as fe,S as me,U as ve}from"./vue-core-BRXIlfIm.js";import{g as Z,i as Y,d as z,j as le,e as E,f as U,h as F,c as se,a as j,m as pe,n as ge,k as _e}from"./index-CV_FLzGV.js";import{i as he,e as be}from"./date-ui-TtEhfnKH.js";import{_ as xe,s as ye}from"./site-CInGcP8Y.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vuetify-ui-CxbL1ZWO.js";const ke={id:"checkin",class:"h-100"},Ce={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},Ve={class:"d-flex justify-end w-100"},$e={class:"w-25 w-sm-auto text-center"},Ie={class:"mt-3 ga-2 d-flex justify-md-end flex-nowrap"},De={class:"d-flex justify-space-between w-100"},Se={class:"pl-4 pt-2 mt-2 mr-1 rounded-te-xl bg-blue-darken-3 text-subtitle-1",style:{height:"40px"}},Ue={class:"d-flex flex-column flex-md-row flex-lg-row justify-start",style:{"line-height":"1.4"}},Re={class:"text-body-2 text-no-wrap w-100 w-md-50"},Pe={class:"text-body-2 text-no-wrap w-100 w-md-50"},Te=te({__name:"ShopSearchForm",props:{activeTab:{default:()=>({})},memberInfo:{}},emits:["close-form"],setup(Q,{emit:A}){const V=Q,g=A,v="/RentalDemo/",o=s(!1),x=s(""),_=s(""),y=s(!1),S=s(!1),L=s(null),f=s({start_time:"",end_time:""}),b=s({startDateRule:[p=>!!p||"請選擇起始日期",p=>{if(!p||!f.value.end_time)return!0;const l=new Date(p),m=new Date(f.value.end_time);return!l||!m?!0:!be(l,m)||"起始日期不能晚於結束日期"}],endDateRule:[p=>!!p||"請選擇結束日期",p=>{if(!p||!f.value.start_time)return!0;const l=new Date(f.value.start_time),m=new Date(p);return!l||!m?!0:!he(m,l)||"結束日期不能早於起始日期"}]}),w=s([]);async function q(){const{valid:p}=await L.value?.validate()??{valid:!1};if(!p)return;const{start_time:l,end_time:m}=f.value,N={vendorId:V.memberInfo?.vendorId,start_time:X(l),end_time:X(m)};S.value=!0;const u="/member/grand_hotel/select_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const B=await J.post(u,N),{returnCode:O,message:h,data:a}=B;if(O===0){if(a.length===0){x.value="訊息通知",_.value="查無折抵記錄，請更改查詢條件後再試。",y.value=!1,o.value=!0,w.value=[];return}w.value=a}else x.value="訊息通知",_.value=`${h}`,y.value=!1,o.value=!0}catch(B){console.log({err:B})}finally{S.value=!1}}function i(){g("close-form")}function M(){o.value=!1}function $(){o.value=!1}return(p,l)=>{const m=ue("v-date-input"),N=ee;return r(),P("div",ke,[e(j,{class:"rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[n("div",{class:"px-4 py-3 d-flex align-center rental__header bg-orange-lighten-5",onClick:i},[e(Z,{class:"mr-2",color:"grey-darken-1",icon:"fa:fas fa-chevron-left",size:"20"}),e(Y,{image:`${T(v)}/images/profile.svg`,size:"30"},null,8,["image"]),n("span",Ce,c(V.memberInfo?.vendor_name)+" [ "+c(V.memberInfo?.acc_name)+" ] ",1)]),e(z,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:t(()=>[e(T(le),{ref_key:"searchFormRef",ref:L},{default:t(()=>[e(E,{class:"flex-0-1",dense:""},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[...l[3]||(l[3]=[n("p",{class:"mt-1 mb-2 text-h6 text-blue-darken-3 text-center text-md-left"}," 折抵記錄查詢 ",-1)])]),_:1}),e(U,{cols:"12",md:"4"},{default:t(()=>[e(m,{modelValue:f.value.start_time,"onUpdate:modelValue":l[0]||(l[0]=u=>f.value.start_time=u),"append-inner-icon":"fa:far fa-calendar-alt","bg-color":"white",color:"blue-darken-2",density:"compact","display-format":T(X),placeholder:"起：2026-01-01","prepend-icon":"",required:"",rules:b.value.startDateRule,variant:"outlined"},null,8,["modelValue","display-format","rules"])]),_:1}),e(U,{cols:"12",md:"4"},{default:t(()=>[e(m,{modelValue:f.value.end_time,"onUpdate:modelValue":l[1]||(l[1]=u=>f.value.end_time=u),"append-inner-icon":"fa:far fa-calendar-alt","bg-color":"white",color:"blue-darken-2",density:"compact","display-format":T(X),placeholder:"迄：2026-01-01","prepend-icon":"",required:"",rules:b.value.endDateRule,variant:"outlined"},null,8,["modelValue","display-format","rules"])]),_:1}),e(U,{cols:"12"},{default:t(()=>[n("div",Ve,[e(F,{class:"px-8 w-75 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-2",height:"40",variant:"flat",onClick:de(q,["prevent"])},{default:t(()=>[...l[4]||(l[4]=[D(" 查詢 ",-1)])]),_:1}),n("div",$e,[e(F,{class:"px-2",color:"blue-darken-2",height:"40",variant:"text"},{default:t(()=>[e(se,{alt:"icon",cover:"",height:"30",src:`${T(v)}/images/ktorrent.svg`,width:"35"},null,8,["src"])]),_:1})])])]),_:1})]),_:1})]),_:1},512),w.value.length>0?(r(),C(z,{key:0,class:"px-0 py-1"},{default:t(()=>[e(E,{"no-gutters":""},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[n("div",Ie,[e(F,{class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",color:"grey-lighten-1",height:"40",variant:"flat",onClick:i},{default:t(()=>[...l[5]||(l[5]=[D(" 全部 ",-1)])]),_:1}),e(F,{class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",color:"grey-lighten-1",height:"40",variant:"flat",onClick:i},{default:t(()=>[...l[6]||(l[6]=[D(" 折抵 ",-1)])]),_:1}),e(F,{class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",color:"grey-lighten-1",height:"40",variant:"flat",onClick:i},{default:t(()=>[...l[7]||(l[7]=[D(" 儲值 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})):R("",!0),w.value.length>0?(r(),C(j,{key:1,class:"bg-white flex-grow-1 overflow-y-auto",variant:"flat"},{default:t(()=>[e(pe,null,{default:t(()=>[(r(!0),P(W,null,K(w.value,u=>(r(),C(ge,{key:u.id,class:"pa-0 border"},{default:t(()=>[n("div",De,[e(E,{class:"align-center flex-grow-1","no-gutters":""},{default:t(()=>[e(U,{cols:"4",md:"3"},{default:t(()=>[n("div",Se,c(u.plate),1)]),_:2},1024),e(U,{class:"text-no-wrap text-center",cols:"3",md:"4"},{default:t(()=>[D(c(u.amount?u.amount:"-")+" 小時 ",1)]),_:2},1024),e(U,{class:"pl-2 text-subtitle-1 text-grey-darken-2",cols:"5",md:"5"},{default:t(()=>[n("div",Ue,[n("div",Re,c(u.discount_time),1),n("div",Pe,c(u.name)+" "+c(u.account),1)])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})]),_:1})):R("",!0)]),_:1})]),_:1}),e(N,{modelValue:o.value,"onUpdate:modelValue":l[2]||(l[2]=u=>o.value=u),"is-confirm-btn":y.value,message:_.value,"message-title":x.value,onOnClose:$,onPromptConfirm:M},null,8,["modelValue","is-confirm-btn","message","message-title"])])}}}),Fe={id:"parkingDeduction",class:"h-100"},Le={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},ze={class:"flex-grow-1 overflow-hidden overflow-y-auto"},Ne={class:"d-flex justify-center my-8"},Be={key:0},je={key:1,class:"text-h3"},Ae={key:0},Me={class:"py-2 text-h6 font-weight-bold"},qe={class:"my-1"},Oe={class:"text-h3 font-weight-bold"},He={class:"my-4 text-h6"},Ee={class:"ma-4 d-flex align-center justify-space-around w-100"},Qe={class:"mt-3 d-flex flex-wrap justify-center w-100"},Xe=te({__name:"ParkingDeduction",props:{activeTab:{default:()=>({})},memberInfo:{}},emits:["close-form"],setup(Q,{emit:A}){const V=Q,g=A,v="/RentalDemo/",o=s(!1),x=s(""),_=s(""),y=s(!1),S=s(!1),L=s(null),f=s({license_plate:""}),b=s(null),w=s([]),q=s({carRules:[h=>!!h||"車號為必填",h=>!/[-]/.test(h)||"車號不需輸入 - 符號"]}),i=s(null),M=s([]),$=s(null);async function p(){if(!V.memberInfo?.vendorId)return;const h={id:V.memberInfo.vendorId};S.value=!0;const a="/member/grand_hotel/get_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const k=await J.post(a,h),{returnCode:d,message:I,data:H}=k;d===0?(i.value=H[0],M.value=H[0].slipHour.split(",").map(Number)):(x.value="訊息通知",_.value=`${I}`,y.value=!1,o.value=!0)}catch(k){console.log({err:k})}finally{S.value=!1}}ae(async()=>{await p()});async function l(){b.value=null,w.value=[];const{valid:h}=await L.value?.validate()??{valid:!1};if(!h)return;const{license_plate:a}=f.value,k={license_plate:a};S.value=!0;const d="/member/grand_hotel/car_in_park_sel?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const I=await J.post(d,k),{returnCode:H,message:ne,data:G,discount:oe}=I;H===0?(b.value=G,w.value=oe,G.ischeck!==0&&(x.value="訊息通知",_.value=G.ischeck===1?`${a} 已進行住宿折抵，無法重複折抵`:`${a} 折抵已到達上限，無法再折抵`,y.value=!1,o.value=!0)):(x.value="訊息通知",_.value=`${ne}`,y.value=!1,o.value=!0)}catch(I){console.log({err:I})}finally{S.value=!1}}function m(h){$.value=h}async function N(){if(!$.value){x.value="訊息通知",_.value="請選擇折抵時數",y.value=!1,o.value=!0;return}const h={vendorId:i.value?.vendorId,store_type:i.value?.store_type,license_plate:f.value.license_plate,count:$.value,userId:V.memberInfo?.userId};S.value=!0;const a="/member/grand_hotel/register_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const k=await J.post(a,h),{returnCode:d,message:I}=k;d===0?(await p(),L.value?.reset(),b.value=null,w.value=[],$.value=null,x.value="訊息通知",_.value=`${I}`,y.value=!1,o.value=!0):(x.value="訊息通知",_.value=`${I}`,y.value=!1,o.value=!0)}catch(k){console.log({err:k})}finally{S.value=!1}}function u(){g("close-form")}function B(){o.value=!1}function O(){o.value=!1}return(h,a)=>{const k=ee;return r(),P("div",Fe,[e(j,{class:"rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[n("div",{class:"px-4 py-3 d-flex align-center rental__header bg-orange-lighten-5",onClick:u},[e(Z,{class:"mr-2",color:"grey-darken-1",icon:"fa:fas fa-chevron-left",size:"20"}),e(Y,{image:`${T(v)}/images/profile.svg`,size:"30"},null,8,["image"]),n("span",Le,c(V.memberInfo?.vendor_name)+" [ "+c(V.memberInfo?.acc_name)+" ] ",1)]),e(z,{class:"pb-2 d-flex flex-column",style:{height:"calc(100% - 64px)"}},{default:t(()=>[n("div",ze,[n("div",Ne,[e(Y,{color:"blue-darken-3",size:"170"},{default:t(()=>[i.value?.remainPoints===-1?(r(),P("span",Be,[e(Z,{class:"",icon:"fa:fas fa-infinity",size:"80"})])):(r(),P("span",je,c(i.value?.remainPoints),1))]),_:1})]),e(T(le),{ref_key:"searchFormRef",ref:L},{default:t(()=>[e(E,{dense:""},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[e(_e,{modelValue:f.value.license_plate,"onUpdate:modelValue":a[0]||(a[0]=d=>f.value.license_plate=d),modelModifiers:{trim:!0},autocomplete:"off","bg-color":"white",class:"pr-0",color:"blue-darken-2",density:"compact",placeholder:"請輸入車號",required:"",rules:q.value.carRules,variant:"outlined",onInput:a[1]||(a[1]=d=>f.value.license_plate=f.value.license_plate.toUpperCase())},{"append-inner":t(()=>[e(F,{class:"mr-n3 px-3",color:"blue-darken-3",height:"40",type:"button",variant:"flat",onClick:l},{default:t(()=>[...a[4]||(a[4]=[D(" 查詢 ",-1)])]),_:1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512),b.value?(r(),P("div",Ae,[e(j,{class:"mt-3 py-5 px-2 rounded-lg bg-blue-darken-3 text-center",variant:"flat"},{default:t(()=>[a[5]||(a[5]=n("p",null,"入場資訊",-1)),n("p",Me,c(b.value.license_plate),1),n("p",null,c(b.value.arrival_time),1)]),_:1}),e(j,{class:"mt-5 pa-2 d-flex flex-column align-center rounded-lg bordered border-md bg-white",variant:"outlined"},{default:t(()=>[a[10]||(a[10]=n("p",{class:"my-4 text-h6"},"應繳金額",-1)),n("p",qe,[a[6]||(a[6]=n("span",{class:"mr-1"},"NT$",-1)),n("span",Oe,c(b.value.paymentAmount),1)]),n("p",He,c(i.value?.slipStyle===20?"當次折抵":"折抵時數"),1),n("div",Ee,[i.value?.slipStyle===18||i.value?.slipStyle===19?(r(!0),P(W,{key:0},K(M.value,(d,I)=>(r(),C(F,{key:I,class:"my-2 mx-1 px-4 text-none rounded-pill",color:$.value===d?"blue-lighten-1":"blue-darken-3",disabled:b.value.ischeck!==0||i.value?.remainPoints!==void 0&&i.value?.remainPoints<1,height:"40",type:"button",variant:"flat",onClick:H=>m(d)},{default:t(()=>[D(c(d)+" hr ",1)]),_:2},1032,["color","disabled","onClick"]))),128)):R("",!0),i.value?.slipStyle===19||i.value?.slipStyle===20?(r(),C(F,{key:1,class:"my-2 mx-1 px-4 text-none rounded-pill",color:$.value===24?"blue-lighten-1":"blue-darken-3",height:"40",type:"button",variant:"flat",onClick:a[2]||(a[2]=d=>m(24))},{default:t(()=>[...a[7]||(a[7]=[D(" 24 hr ",-1)])]),_:1},8,["color"])):R("",!0)]),n("div",Qe,[b.value.ischeck===0||i.value?.remainPoints!==void 0&&i.value?.remainPoints>0?(r(),C(F,{key:0,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"red-darken-1",height:"40",variant:"flat",onClick:N},{default:t(()=>[...a[8]||(a[8]=[D(" 折抵 ",-1)])]),_:1})):(r(),C(F,{key:1,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-3",height:"40",variant:"flat",onClick:u},{default:t(()=>[...a[9]||(a[9]=[D(" 回上一頁 ",-1)])]),_:1}))]),w.value.length>0?(r(),C(j,{key:0,class:"my-2 pa-3 rounded-lg bg-grey-lighten-4 w-100",variant:"flat"},{default:t(()=>[e(E,{dense:""},{default:t(()=>[(r(!0),P(W,null,K(w.value,(d,I)=>(r(),P(W,{key:I},[e(U,{class:"text-grey-darken-1",cols:"8"},{default:t(()=>[D(c(d.vendor_name),1)]),_:2},1024),e(U,{class:"text-grey-darken-1",cols:"4"},{default:t(()=>[D(c(d.amount)+" "+c(d.store_type===1||d.store_type===5?"hr":"NT$"),1)]),_:2},1024)],64))),128))]),_:1})]),_:1})):R("",!0)]),_:1})])):R("",!0)])]),_:1})]),_:1}),e(k,{modelValue:o.value,"onUpdate:modelValue":a[3]||(a[3]=d=>o.value=d),"is-confirm-btn":y.value,message:_.value,"message-title":x.value,onOnClose:O,onPromptConfirm:B},null,8,["modelValue","is-confirm-btn","message","message-title"])])}}}),Je={id:"shopView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},We={class:"pt-2 d-flex align-center"},Ye={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},Ge=te({__name:"shop",setup(Q){const A="/RentalDemo/",V=ce(),g=s(null),v=s(null),o=s(!1),x=s(!1),_=s(!1),y=s(""),S=s(""),L=s(!1);function f(l){v.value=l,o.value=!0,l.value==="logout"&&(localStorage.removeItem("memberInfo"),g.value=null)}function b(){v.value=null,o.value=!1}function w(){v.value=null,o.value=!1,V.push("/shopLogin")}function q(){v.value=null,o.value=!1}function i(){_.value=!1}function M(){_.value=!1}function $(){x.value=window.innerWidth<=960}function p(){const l=localStorage.getItem("memberInfo");l?g.value=JSON.parse(l):V.push("/shopLogin")}return ae(()=>{p(),$(),window.addEventListener("resize",$)}),fe(()=>{window.removeEventListener("resize",$)}),(l,m)=>{const N=xe,u=Xe,B=Te,O=re,h=ie,a=ee;return r(),P("div",Je,[me(e(z,{class:"pb-1 rental rental__wrapper"},{default:t(()=>[e(j,{class:"pa-2",elevation:"4",variant:"elevated"},{default:t(()=>[e(se,{alt:"Shop Image",color:"surface-variant",cover:"",height:"200",src:`${T(A)}/images/hotel_01.png`,width:"100%"},{default:t(()=>[...m[1]||(m[1]=[n("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},"商店消費停車折抵",-1)])]),_:1},8,["src"]),n("div",We,[e(Y,{image:`${T(A)}/images/profile.svg`,size:"30"},null,8,["image"]),n("span",Ye,c(g.value&&g.value.vendor_name)+" "+c(g.value&&g.value.acc_name)+" 您好！ ",1)])]),_:1}),o.value?R("",!0):(r(),C(N,{key:0,"tab-list":T(ye),onSetActiveTab:f},null,8,["tab-list"]))]),_:1},512),[[ve,!x.value||!o.value]]),v.value?.value==="parkingDeduction"&&g.value?(r(),C(z,{key:0,id:"parkingDeduction",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(u,{"active-tab":v.value,"member-info":g.value,onCloseForm:b},null,8,["active-tab","member-info"])]),_:1})):R("",!0),v.value?.value==="search"&&g.value?(r(),C(z,{key:1,id:"search",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(B,{"active-tab":v.value,"member-info":g.value,onCloseForm:b},null,8,["active-tab","member-info"])]),_:1})):R("",!0),v.value?.value==="logout"?(r(),C(z,{key:2,id:"logout",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(O,{"active-tab":v.value,onOnLogin:w},null,8,["active-tab"])]),_:1})):R("",!0),v.value?.value==="changePassword"&&g.value?(r(),C(z,{key:3,id:"changePassword",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(h,{"active-tab":v.value,"user-info":g.value,onOnClose:q},null,8,["active-tab","user-info"])]),_:1})):R("",!0),e(a,{modelValue:_.value,"onUpdate:modelValue":m[0]||(m[0]=k=>_.value=k),"is-confirm-btn":L.value,message:S.value,"message-title":y.value,onOnClose:M,onPromptConfirm:i},null,8,["modelValue","is-confirm-btn","message","message-title"])])}}}),ot=we(Ge,[["__scopeId","data-v-98877b33"]]);export{ot as default};
