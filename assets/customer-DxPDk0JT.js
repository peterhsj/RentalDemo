import{_ as Y,a as P}from"./index-BeZC1qu4.js";import{l as J,ah as K,H as Z,a3 as ee,ad as C,aa as _,n as t,ab as l,v as n,u as A,Y as c,k as s,af as D,a0 as h,a9 as ae,F,ae as te}from"./vue-core-BRXIlfIm.js";import{a as N,i as le,d as M,j as se,e as T,f as q,k as ne,h as U}from"./index-R6LO0SYh.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./date-ui-TtEhfnKH.js";import"./vuetify-ui-CxbL1ZWO.js";const re={id:"banquet",class:"d-flex flex-column bg-grey-lighten-4 h-100"},ue={class:"px-4 py-3 d-flex align-center bg-orange-lighten-5"},ie={class:"ml-3 text-h6 font-weight-bold text-grey-darken-2"},ce={class:"h-100"},de={key:0},ve={class:"py-2 text-h5 font-weight-bold"},fe={class:"mt-5 d-flex flex-column align-center justify-center"},me={class:"my-1"},pe={class:"text-h3 font-weight-bold"},ge={class:"mt-3 d-flex flex-wrap justify-center w-100"},_e={class:"mt-3 d-flex flex-wrap justify-center w-100"},he=J({__name:"customer",setup(ye){const I="/RentalDemo/",y=K(),z=s(!1);function w(o){try{const e=atob(o),i=Uint8Array.from(e,a=>a.codePointAt(0)??0);return new TextDecoder().decode(i)}catch(e){return console.error("Base64 解碼錯誤:",e),o}}const r=s({}),u=s({});function E(){r.value={c:y.query.c,v:y.query.v,u:y.query.u,vn:y.query.vn},r.value.c&&(u.value.c=Number(w(r.value.c))),r.value.v&&(u.value.v=Number(w(r.value.v))),r.value.u&&(u.value.u=Number(w(r.value.u))),r.value.vn&&(u.value.vn=w(r.value.vn))}const x=s(!1),d=s(!1),b=s(""),p=s(""),g=s(!1),$=s(null),m=s({license_plate:""}),L=s({carRules:[o=>!!o||"車號為必填",o=>!/[-]/.test(o)||"車號不需輸入 - 符號"]}),j=s(!0),v=s(null),k=s([]);async function B(){v.value=null,k.value=[];const{valid:o}=await $.value?.validate()??{valid:!1};if(!o)return;const{license_plate:e}=m.value,i={license_plate:e};x.value=!0;const a="/member/grand_hotel/car_in_park_sel?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const f=await P.post(a,i),{returnCode:X,message:H,data:R,discount:W}=f;X===0?(v.value=R,k.value=W,R.ischeck===3&&(b.value="訊息通知",p.value=`${e} 已進行宴會廳折抵，無法重複折抵`,g.value=!1,d.value=!0)):(b.value="訊息通知",p.value=`${H}`,g.value=!1,d.value=!0)}catch(f){console.log({err:f})}finally{x.value=!1}}async function Q(){const o={license_plate:v.value?.license_plate,count:u.value.c,vendorId:u.value.v,userId:u.value.u};x.value=!0;const e="/member/grand_hotel/register_qr?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const i=await P.post(e,o),{returnCode:a,message:f}=i;a===0?(B(),p.value=`${f}`,g.value=!1,d.value=!0):(b.value="訊息通知",p.value=`${f}`,g.value=!1,d.value=!0)}catch(i){console.log({err:i})}finally{x.value=!1}}function G(){window.open(`https://rental.mitwit-cre.com.tw/service/payment/GE1AS9DOE3MG4I/bill/${m.value.license_plate}`,"_blank")}function O(){d.value=!1}function S(){d.value=!1}function V(){z.value=window.innerWidth<=960}return Z(()=>{V(),window.addEventListener("resize",V),E()}),ee(()=>{window.removeEventListener("resize",V)}),(o,e)=>{const i=Y;return _(),C("div",re,[t(M,{id:"search",class:"rental rental__wrapper h-100",style:{"max-width":"600px"}},{default:l(()=>[t(N,{class:"rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:l(()=>[n("div",ue,[t(le,{image:`${A(I)}/images/check.svg`,size:"40"},null,8,["image"]),n("span",ie,c(u.value.vn),1)]),t(M,{class:"pb-2 d-flex flex-column flex-grow-1 overflow-y-auto",style:{height:"calc(100% - 64px)"}},{default:l(()=>[n("div",ce,[t(A(se),{ref_key:"searchFormRef",ref:$,class:"pt-4 py-1"},{default:l(()=>[t(T,{dense:""},{default:l(()=>[t(q,{cols:"12"},{default:l(()=>[t(ne,{modelValue:m.value.license_plate,"onUpdate:modelValue":e[0]||(e[0]=a=>m.value.license_plate=a),modelModifiers:{trim:!0},autocomplete:"off","bg-color":"white",class:"pr-0",color:"blue-darken-2",density:"compact",placeholder:"請輸入車號",required:"",rules:L.value.carRules,variant:"outlined",onInput:e[1]||(e[1]=a=>m.value.license_plate=m.value.license_plate.toUpperCase())},{"append-inner":l(()=>[t(U,{class:"mr-n3 px-3",color:"blue-darken-3",height:"40",type:"button",variant:"flat",onClick:B},{default:l(()=>[...e[3]||(e[3]=[h(" 查詢 ",-1)])]),_:1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512),v.value?(_(),C("div",de,[t(N,{class:"py-5 px-2 rounded-lg bg-blue-darken-3 text-center",variant:"flat"},{default:l(()=>[e[4]||(e[4]=n("p",{class:"py-2 text-h6 font-weight-regular"},"入場資訊",-1)),n("p",ve,c(v.value.license_plate),1),n("p",null,c(v.value.arrival_time),1)]),_:1}),n("div",fe,[e[6]||(e[6]=n("p",{class:"my-4 text-h6"},"應繳金額",-1)),n("p",me,[e[5]||(e[5]=n("span",{class:"mr-1"},"NT$",-1)),n("span",pe,c(v.value.paymentAmount),1)])]),n("div",ge,[t(U,{class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular text-white",color:"light-green-darken-2",disabled:v.value.ischeck===3,height:"60","min-width":"200",variant:"flat",onClick:Q},{default:l(()=>[h(" 折抵 "+c(u.value.c)+" 小時 ",1)]),_:1},8,["disabled"])]),n("div",_e,[t(U,{class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"orange-darken-2",disabled:!j.value,height:"60","min-width":"200",variant:"flat",onClick:G},{default:l(()=>[...e[7]||(e[7]=[h(" 線上繳費 ",-1)])]),_:1},8,["disabled"])]),k.value.length>0?(_(),ae(N,{key:0,class:"my-5 pa-3 rounded-lg bg-grey-lighten-4 w-100",variant:"flat"},{default:l(()=>[t(T,{dense:""},{default:l(()=>[(_(!0),C(F,null,te(k.value,(a,f)=>(_(),C(F,{key:f},[t(q,{class:"text-grey-darken-1",cols:"8"},{default:l(()=>[h(c(a.vendor_name),1)]),_:2},1024),t(q,{class:"text-grey-darken-1",cols:"4"},{default:l(()=>[h(c(a.store_type===2?"$":"")+" "+c(a.amount)+" "+c(a.store_type===1||a.store_type===5?"hr":""),1)]),_:2},1024)],64))),128))]),_:1})]),_:1})):D("",!0)])):D("",!0)])]),_:1})]),_:1}),t(i,{modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),"is-confirm-btn":g.value,message:p.value,"message-title":b.value,onOnClose:S,onPromptConfirm:O},null,8,["modelValue","is-confirm-btn","message","message-title"])]),_:1})])}}}),Ne=oe(he,[["__scopeId","data-v-d282d718"]]);export{Ne as default};
