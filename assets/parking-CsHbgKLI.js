import{_ as le,a as oe}from"./Captcha-DCFtyyQr.js";import{_ as ne,a as H}from"./index-CS9D0syF.js";import{d as D,a as q,c as X,e as N,f as y,h as M,g as se,i as re,j as ie,k as z}from"./index-HNcXKezP.js";import{l as A,a9 as C,aa as h,ab as t,n as e,v as f,u as U,af as T,a0 as S,r as ue,y as O,ad as Y,Y as Q,a5 as ce,k as i,H as de,a3 as fe,S as pe,U as me}from"./vue-core-BRXIlfIm.js";import{_ as ve,p as ge}from"./site-rDgTmd47.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./date-ui-TtEhfnKH.js";import"./vuetify-ui-CxbL1ZWO.js";const _e={class:"d-flex flex-column align-center justify-center"},xe={class:"my-4"},be=["innerHTML"],we={class:"d-flex ga-2 flex-wrap justify-center w-100"},ke=A({__name:"InfoView",props:{info:{default:""},infoStatus:{default:"success"}},emits:["info-close","re-write"],setup(P,{emit:I}){const p="/RentalDemo/",o=P,n=I;function V(){n("info-close")}function c(){n("re-write")}return(l,r)=>(h(),C(D,{class:"rental rental__wrapper flex-grow-1"},{default:t(()=>[e(q,{class:"mb-5 pt-5 d-flex flex-column justify-space-between rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[f("div",_e,[f("span",xe,[e(X,{alt:"icon image",cover:"",height:"100%",src:o.infoStatus==="success"?`${U(p)}/images/check.svg`:`${U(p)}/images/warning.svg`,width:"120px"},null,8,["src"])]),f("div",{class:"d-flex flex-column align-center justify-center pa-6",innerHTML:o.info},null,8,be)]),e(D,{class:"py-2"},{default:t(()=>[e(N,{"no-gutters":""},{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[f("div",we,[o.infoStatus!=="error"?(h(),C(M,{key:0,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-3",height:"40",variant:"flat",onClick:V},{default:t(()=>[...r[0]||(r[0]=[S(" 離開 ",-1)])]),_:1})):T("",!0),o.infoStatus==="error"?(h(),C(M,{key:1,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"orange-darken-3",height:"40",variant:"flat",onClick:c},{default:t(()=>[...r[1]||(r[1]=[S(" 重新輸入 ",-1)])]),_:1})):T("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),ye={id:"search",class:"h-100"},Ce={class:"ml-3 text-h6 font-weight-bold text-grey-darken-2"},Ve={style:{width:"120px",height:"40px"}},Fe={class:"d-flex ga-2 flex-wrap justify-end w-100"},$e=A({__name:"ParkingSearchForm",props:{activeTab:{default:()=>({})},formData:{default:()=>({ischeck:0,phone:"",license_plate:"",captcha:""})}},emits:["update:formData","close-form","send-form"],setup(P,{expose:I,emit:p}){const o=P,n=p,V="/RentalDemo/",c=i(null),l=ue(o.formData),r=i({phoneRules:[a=>!!a||"手機號碼為必填",a=>/^\d{10}$/.test(a)||"請輸入有效的手機號碼"],carRules:[a=>!!a||"車號為必填",a=>!/[-]/.test(a)||"車號不需輸入 - 符號"],captchaRules:[a=>!!a||"驗證碼為必填",a=>a===_.value||"請輸入有效的驗證碼"]});O(()=>o.formData,a=>{Object.assign(l,a)},{deep:!0}),O(()=>l,a=>{n("update:formData",a)},{deep:!0});const _=i("");function F(a){_.value=a}async function v(){const{valid:a}=await c.value?.validate()??{valid:!1};a&&n("send-form")}function x(){n("close-form")}function $(){c.value?.reset()}return I({initForm:$}),(a,s)=>{const j=le;return h(),Y("div",ye,[e(q,{class:"rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[f("div",{class:"px-4 py-3 d-flex align-center bg-orange-lighten-5 rental__header",onClick:x},[e(se,{class:"mr-2",color:"grey-darken-1",icon:"fa:fas fa-chevron-left",size:"20"}),e(re,{image:`${U(V)}${o.activeTab.icon}`,size:"40"},null,8,["image"]),f("span",Ce,Q(o.activeTab.title),1)]),e(U(ie),{ref_key:"parkingFormRef",ref:c,class:"h-100",onSubmit:ce(v,["prevent"])},{default:t(()=>[e(D,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:t(()=>[e(N,{class:"flex-0-1",dense:""},{default:t(()=>[e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:l.phone,"onUpdate:modelValue":s[0]||(s[0]=m=>l.phone=m),autocomplete:"off",color:"blue-darken-2",density:"compact",placeholder:o.activeTab.value==="parking"?"請輸入手機號碼":"請輸入登記手機號碼",required:"",rules:r.value.phoneRules,variant:"outlined"},null,8,["modelValue","placeholder","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:l.license_plate,"onUpdate:modelValue":s[1]||(s[1]=m=>l.license_plate=m),autocomplete:"off",color:"blue-darken-2",density:"compact",placeholder:o.activeTab.value==="parking"?"請輸入車號":"請輸入已登記車號",required:"",rules:r.value.carRules,variant:"outlined",onInput:s[2]||(s[2]=m=>l.license_plate=l.license_plate.toUpperCase())},null,8,["modelValue","placeholder","rules"])]),_:1}),e(y,{class:"py-0",cols:"12"},{default:t(()=>[...s[5]||(s[5]=[f("p",{class:"text-subtitle-1 font-weight-bold"},"驗證碼",-1)])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(z,{modelValue:l.captcha,"onUpdate:modelValue":s[3]||(s[3]=m=>l.captcha=m),autocomplete:"off",color:"blue-darken-2",density:"compact",placeholder:"請輸入驗證碼",required:"",rules:r.value.captchaRules,variant:"outlined",onInput:s[4]||(s[4]=m=>l.captcha=l.captcha.toUpperCase())},{append:t(()=>[f("div",Ve,[e(j,{onSetCaptchaCode:F})])]),_:1},8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[...s[6]||(s[6]=[f("p",{class:"text-subtitle-2 text-red-darken-1"},[S(" 注意："),f("br"),S(" 更換車號請重新操作，入場當日無法更換登記車號。 ")],-1)])]),_:1})]),_:1}),e(N,{class:"flex-0-1","no-gutters":""},{default:t(()=>[e(y,{class:"mt-4",cols:"12"},{default:t(()=>[f("div",Fe,[e(M,{class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"light-green-darken-2",height:"40",type:"submit",variant:"flat"},{default:t(()=>[S(Q(o.activeTab.value==="parking"?"登記":"查詢"),1)]),_:1}),e(M,{class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-3",height:"40",variant:"flat",onClick:x},{default:t(()=>[...s[7]||(s[7]=[S(" 離開 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})])}}}),Re={id:"parkingView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},Te=A({__name:"parking",setup(P){const I="/RentalDemo/",p=i(!1),o=i(null),n=i(!1),V=i(!1),c=i(),l=i({ischeck:0,phone:"",license_plate:"",captcha:""}),r=i(!1),_=i(""),F=i(""),v=i(!1),x=i(""),$=i(""),a=i(!1);function s(b){if(b.value==="parkingInfo"){window.open("https://www.grand-hotel.org/TW/official/about-traffic.aspx?gh=TP","_blank");return}o.value=b,n.value=!0}async function j(){const{ischeck:b,phone:u,license_plate:B}=l.value,R={ischeck:b,phone:u,license_plate:B};p.value=!0;const w="/member/grand_hotel/register_cus?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const g=await H.post(w,R),{returnCode:k,message:d}=g;k===0?m():k===-1?(_.value=`<p class="my-2 text-h4 text-grey-darken-1 font-weight-bold">
            查無登記資訊
          </p>
          <p class="mt-4 mb-7 text-h5 text-amber-darken-3 font-weight-bold text-center">
            請重新確認登記手機號碼或再次輸入
          </p>
          <p class="mt-7 mb-0 text-h5 text-grey-darken-1 text-center">
            另可聯繫飯店客服<br>
            02-1234567
          </p>`,n.value=!1,r.value=!0,F.value="error",c.value?.initForm()):k===3?(x.value="登記手機號碼已有申請車輛",$.value=`${d}`,a.value=!0,v.value=!0):(x.value="訊息通知",$.value=`${d}`,a.value=!1,v.value=!0)}catch(g){console.log({err:g})}finally{p.value=!1}}async function m(){const{phone:b,license_plate:u}=l.value,B={phone:b,license_plate:u};p.value=!0;const R="/member/grand_hotel/select_cus?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const w=await H.post(R,B),{returnCode:g,message:k,data:d}=w;if(g===0&&d&&d.length>0){const W=d[0];if(W){const{license_plate:ee,reserve_start_date:te,reserve_end_date:ae}=W;n.value=!1,r.value=!0,F.value="success",_.value=`<p class="text-h4 text-grey-darken-1 font-weight-bold my-2">
            已完成登記
          </p>
          <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-3">
            車號
          </p>
          <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
            ${ee}
          </p>
          <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-4">
            停放日期
          </p>
          <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
            ${te} ~ ${ae}
          </p>`,c.value?.initForm()}}else g===-1&&(_.value=`<p class="my-2 text-h4 text-grey-darken-1 font-weight-bold">
            ${k}
          </p>
          <p class="mt-4 mb-7 text-h5 text-amber-darken-3 font-weight-bold text-center">
            請重新確認登記手機號碼或再次輸入
          </p>
          <p class="mt-7 mb-0 text-h5 text-grey-darken-1 text-center">
            另可聯繫飯店客服<br>
            02-1234567
          </p>`,n.value=!1,r.value=!0,F.value="error",c.value?.initForm()),g===3&&(x.value="登記手機號碼已有申請車輛",$.value=`<p>此電話已經申請車號 ${u}，確認是否要覆蓋原有車號？</p>`,a.value=!0,v.value=!0)}catch(w){console.log({err:w})}finally{p.value=!1}}function E(){o.value=null,c.value?.initForm(),n.value=!1}function G(){r.value=!1,n.value=!0}function J(){r.value=!1,n.value=!1,o.value=null,l.value={ischeck:0,phone:"",license_plate:"",captcha:""}}function K(){l.value.ischeck=1,j(),v.value=!1}function Z(){v.value=!1}function L(){V.value=window.innerWidth<=960}return de(()=>{L(),window.addEventListener("resize",L)}),fe(()=>{window.removeEventListener("resize",L)}),(b,u)=>{const B=ve,R=$e,w=ke,g=ne,k=oe;return h(),Y("div",Re,[pe(e(D,{class:"pb-1 rental rental__wrapper"},{default:t(()=>[e(q,{class:"pa-2",elevation:"4",variant:"elevated"},{default:t(()=>[e(X,{alt:"Parking Image",color:"surface-variant",cover:"",height:"200",src:`${U(I)}/images/hotel_01.png`,width:"100%"},{default:t(()=>[...u[3]||(u[3]=[f("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},"住宿車輛登記",-1)])]),_:1},8,["src"])]),_:1}),!n.value&&!r.value?(h(),C(B,{key:0,"tab-list":U(ge),onSetActiveTab:s},null,8,["tab-list"])):T("",!0)]),_:1},512),[[me,(!V.value||!n.value)&&!r.value]]),n.value&&o.value?.value==="parking"?(h(),C(D,{key:0,id:"parking",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(R,{ref_key:"searchFormRef",ref:c,"form-data":l.value,"onUpdate:formData":u[0]||(u[0]=d=>l.value=d),"active-tab":o.value,onCloseForm:E,onSendForm:j},null,8,["form-data","active-tab"])]),_:1})):T("",!0),n.value&&o.value?.value==="search"?(h(),C(D,{key:1,id:"search",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(R,{ref_key:"searchFormRef",ref:c,"form-data":l.value,"onUpdate:formData":u[1]||(u[1]=d=>l.value=d),"active-tab":o.value,onCloseForm:E,onSendForm:m},null,8,["form-data","active-tab"])]),_:1})):T("",!0),r.value?(h(),C(w,{key:2,info:_.value,"info-status":F.value,onInfoClose:J,onReWrite:G},null,8,["info","info-status"])):T("",!0),e(g,{modelValue:v.value,"onUpdate:modelValue":u[2]||(u[2]=d=>v.value=d),"is-confirm-btn":a.value,message:$.value,"message-title":x.value,onOnClose:Z,onPromptConfirm:K},null,8,["modelValue","is-confirm-btn","message","message-title"]),e(k,{overlay:p.value},null,8,["overlay"])])}}}),Le=he(Te,[["__scopeId","data-v-3f81c18d"]]);export{Le as default};
