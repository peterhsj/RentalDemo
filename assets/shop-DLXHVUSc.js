import{_ as ee}from"./PromptDialog.vue_vue_type_script_setup_true_lang-DQjf_76p.js";import{f as J,_ as ie,a as ue}from"./Logout.vue_vue_type_script_setup_true_lang-CPjsSwSh.js";import{l as te,a7 as de,ad as F,aa as o,n as e,ab as t,v as n,u as P,Y as d,a9 as y,af as $,k as l,a5 as ce,a0 as V,F as K,ae as G,K as le,ag as fe,a3 as me,S as ve,U as pe}from"./vue-core-Bc_tOqtV.js";import{a as W}from"./index-BFZgDbVB.js";import{g as Z,p as Y,m as A,q as se,n as Q,o as U,f as T,l as ne,j as q,h as ge,i as _e,r as he}from"./index-CfOFkMNu.js";import{i as be,e as ye}from"./date-ui-TtEhfnKH.js";import{_ as xe,s as we}from"./site-BPkA3pqJ.js";import{_ as ke}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vuetify-ui-EB00uQU6.js";const Ce={id:"checkin",class:"h-100"},Ve={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},$e={class:"d-flex justify-end w-100"},De={class:"w-25 w-sm-auto text-center"},Ie={class:"mt-3 ga-2 d-flex justify-md-end flex-nowrap"},Se={class:"d-flex justify-space-between w-100"},Ue={class:"pl-4 pt-2 mt-2 mr-1 rounded-te-xl bg-blue-darken-3 text-subtitle-1",style:{height:"40px"}},Re={class:"d-flex flex-column flex-md-row flex-lg-row justify-start",style:{"line-height":"1.4"}},Pe={class:"text-body-2 text-no-wrap w-100 w-md-50"},Te={class:"text-body-2 text-no-wrap w-100 w-md-50"},Fe=te({__name:"ShopSearchForm",props:{activeTab:{default:()=>({})},memberInfo:{}},emits:["close-form"],setup(X,{emit:M}){const D=X,g=M,m="/RentalDemo/",r=l(!1),x=l(""),_=l(""),w=l(!1),I=l(!1),R=l(null),h=l({start_time:"",end_time:""}),k=l({startDateRule:[i=>!!i||"請選擇起始日期",i=>{if(!i||!h.value.end_time)return!0;const a=new Date(i),p=new Date(h.value.end_time);return!a||!p?!0:!ye(a,p)||"起始日期不能晚於結束日期"}],endDateRule:[i=>!!i||"請選擇結束日期",i=>{if(!i||!h.value.start_time)return!0;const a=new Date(h.value.start_time),p=new Date(i);return!a||!p?!0:!be(p,a)||"結束日期不能早於起始日期"}]}),v=l([]);async function z(){const{valid:i}=await R.value?.validate()??{valid:!1};if(!i)return;const{start_time:a,end_time:p}=h.value,B={vendorId:D.memberInfo?.vendorId,start_time:J(a),end_time:J(p)};I.value=!0;const c="/member/grand_hotel/select_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const j=await W.post(c,B),{returnCode:O,message:E,data:b}=j;if(O===0){if(b.length===0){x.value="訊息通知",_.value="查無折抵記錄，請更改查詢條件後再試。",w.value=!1,r.value=!0,v.value=[];return}v.value=b}else x.value="訊息通知",_.value=`${E}`,w.value=!1,r.value=!0}catch(j){console.log({err:j})}finally{I.value=!1}}function L(){g("close-form")}function f(){r.value=!1}function N(){r.value=!1}return(i,a)=>{const p=de("v-date-input"),B=ee;return o(),F("div",Ce,[e(q,{class:"rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[n("div",{class:"px-4 py-3 d-flex align-center rental__header bg-orange-lighten-5",onClick:L},[e(Z,{class:"mr-2",color:"grey-darken-1",icon:"fa:fas fa-chevron-left",size:"20"}),e(Y,{image:`${P(m)}/images/profile.svg`,size:"30"},null,8,["image"]),n("span",Ve,d(D.memberInfo?.vendor_name)+" [ "+d(D.memberInfo?.acc_name)+" ] ",1)]),e(A,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:t(()=>[e(P(se),{ref_key:"searchFormRef",ref:R},{default:t(()=>[e(Q,{class:"flex-0-1",dense:""},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[...a[3]||(a[3]=[n("p",{class:"mt-1 mb-2 text-h6 text-blue-darken-3 text-center text-md-left"}," 折抵記錄查詢 ",-1)])]),_:1}),e(U,{cols:"12",md:"4"},{default:t(()=>[e(p,{modelValue:h.value.start_time,"onUpdate:modelValue":a[0]||(a[0]=c=>h.value.start_time=c),"append-inner-icon":"fa:far fa-calendar-alt","bg-color":"white",color:"blue-darken-2",density:"compact","display-format":P(J),placeholder:"起：2026-01-01","prepend-icon":"",required:"",rules:k.value.startDateRule,variant:"outlined"},null,8,["modelValue","display-format","rules"])]),_:1}),e(U,{cols:"12",md:"4"},{default:t(()=>[e(p,{modelValue:h.value.end_time,"onUpdate:modelValue":a[1]||(a[1]=c=>h.value.end_time=c),"append-inner-icon":"fa:far fa-calendar-alt","bg-color":"white",color:"blue-darken-2",density:"compact","display-format":P(J),placeholder:"迄：2026-01-01","prepend-icon":"",required:"",rules:k.value.endDateRule,variant:"outlined"},null,8,["modelValue","display-format","rules"])]),_:1}),e(U,{cols:"12"},{default:t(()=>[n("div",$e,[e(T,{class:"px-8 w-75 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-2",height:"40",variant:"flat",onClick:ce(z,["prevent"])},{default:t(()=>[...a[4]||(a[4]=[V(" 查詢 ",-1)])]),_:1}),n("div",De,[e(T,{class:"px-2",color:"blue-darken-2",height:"40",variant:"text"},{default:t(()=>[e(ne,{alt:"icon",cover:"",height:"30",src:`${P(m)}/images/ktorrent.svg`,width:"35"},null,8,["src"])]),_:1})])])]),_:1})]),_:1})]),_:1},512),v.value.length>0?(o(),y(A,{key:0,class:"px-0 py-1"},{default:t(()=>[e(Q,{"no-gutters":""},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[n("div",Ie,[e(T,{class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",color:"grey-lighten-1",height:"40",variant:"flat",onClick:L},{default:t(()=>[...a[5]||(a[5]=[V(" 全部 ",-1)])]),_:1}),e(T,{class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",color:"grey-lighten-1",height:"40",variant:"flat",onClick:L},{default:t(()=>[...a[6]||(a[6]=[V(" 折抵 ",-1)])]),_:1}),e(T,{class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",color:"grey-lighten-1",height:"40",variant:"flat",onClick:L},{default:t(()=>[...a[7]||(a[7]=[V(" 儲值 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})):$("",!0),v.value.length>0?(o(),y(q,{key:1,class:"bg-white flex-grow-1 overflow-y-auto",variant:"flat"},{default:t(()=>[e(ge,null,{default:t(()=>[(o(!0),F(K,null,G(v.value,c=>(o(),y(_e,{key:c.id,class:"pa-0 border"},{default:t(()=>[n("div",Se,[e(Q,{class:"align-center flex-grow-1","no-gutters":""},{default:t(()=>[e(U,{cols:"4",md:"3"},{default:t(()=>[n("div",Ue,d(c.plate),1)]),_:2},1024),e(U,{class:"pl-2 text-no-wrap",cols:"3",md:"4"},{default:t(()=>[V(d(c.amount?c.amount:"-")+" 小時 ",1)]),_:2},1024),e(U,{class:"pl-2 text-subtitle-1 text-grey-darken-2",cols:"5",md:"5"},{default:t(()=>[n("div",Re,[n("div",Pe,d(c.discount_time),1),n("div",Te,d(c.name)+" "+d(c.account),1)])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})]),_:1})):$("",!0)]),_:1})]),_:1}),e(B,{modelValue:r.value,"onUpdate:modelValue":a[2]||(a[2]=c=>r.value=c),"is-confirm-btn":w.value,message:_.value,"message-title":x.value,onOnClose:N,onPromptConfirm:f},null,8,["modelValue","is-confirm-btn","message","message-title"])])}}}),ze={id:"parkingDeduction",class:"h-100"},Le={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},Ne={class:"flex-grow-1 overflow-hidden overflow-y-auto"},Be={class:"d-flex justify-center my-8"},je={key:0},Ae={key:1,class:"text-h3"},qe={class:"py-2 text-h6 font-weight-bold"},Me={class:"my-1"},Oe={class:"text-h3 font-weight-bold"},Ee={class:"my-4 text-h6"},He={class:"ma-4 d-flex align-center justify-space-around w-100"},Qe={class:"mt-3 d-flex flex-wrap justify-center w-100"},Xe=te({__name:"ParkingDeduction",props:{activeTab:{default:()=>({})},memberInfo:{}},emits:["close-form"],setup(X,{emit:M}){const D=X,g=M,m="/RentalDemo/",r=l(!1),x=l(""),_=l(""),w=l(!1),I=l(!1),R=l(!1),h=l(null),k=l({license_plate:""}),v=l(null),z=l([]),L=l({carRules:[b=>!!b||"車號為必填"]}),f=l(null),N=l([]),i=l(null);async function a(){if(!D.memberInfo?.vendorId)return;const b={id:D.memberInfo.vendorId};I.value=!0;const s="/member/grand_hotel/get_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const S=await W.post(s,b),{returnCode:u,message:C,data:H}=S;u===0?(f.value=H[0],N.value=H[0].slipHour.split(",").map(Number)):(x.value="訊息通知",_.value=`${C}`,w.value=!1,r.value=!0)}catch(S){console.log({err:S})}finally{I.value=!1}}le(async()=>{await a()});async function p(){const{valid:b}=await h.value?.validate()??{valid:!1};if(!b)return;const{license_plate:s}=k.value,S={license_plate:s};I.value=!0;const u="/member/grand_hotel/car_in_park_sel?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const C=await W.post(u,S),{returnCode:H,message:oe,data:ae,discount:re}=C;H===0?(v.value=ae,z.value=re,R.value=ae.ischeck===0):(x.value="訊息通知",_.value=`${oe}`,w.value=!1,r.value=!0)}catch(C){console.log({err:C})}finally{I.value=!1}}function B(b){i.value=b}async function c(){if(!i.value){x.value="訊息通知",_.value="請選擇折抵時數",w.value=!1,r.value=!0;return}const b={vendorId:f.value?.vendorId,store_type:f.value?.store_type,license_plate:k.value.license_plate,count:i.value};I.value=!0;const s="/member/grand_hotel/register_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const S=await W.post(s,b),{returnCode:u,message:C}=S;u===0?(await a(),h.value?.reset(),v.value={},z.value=[],i.value=null,R.value=!1,x.value="訊息通知",_.value=`${C}`,w.value=!1,r.value=!0):(x.value="訊息通知",_.value=`${C}`,w.value=!1,r.value=!0)}catch(S){console.log({err:S})}finally{I.value=!1}}function j(){g("close-form")}function O(){r.value=!1}function E(){r.value=!1}return(b,s)=>{const S=ee;return o(),F("div",ze,[e(q,{class:"rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[n("div",{class:"px-4 py-3 d-flex align-center rental__header bg-orange-lighten-5",onClick:j},[e(Z,{class:"mr-2",color:"grey-darken-1",icon:"fa:fas fa-chevron-left",size:"20"}),e(Y,{image:`${P(m)}/images/profile.svg`,size:"30"},null,8,["image"]),n("span",Le,d(D.memberInfo?.vendor_name)+" [ "+d(D.memberInfo?.acc_name)+" ] ",1)]),e(A,{class:"pb-2 d-flex flex-column",style:{height:"calc(100% - 64px)"}},{default:t(()=>[n("div",Ne,[n("div",Be,[e(Y,{color:"blue-darken-3",size:"170"},{default:t(()=>[f.value?.remainPoints===-1?(o(),F("span",je,[e(Z,{class:"",icon:"fa:fas fa-infinity",size:"80"})])):(o(),F("span",Ae,d(f.value?.remainPoints),1))]),_:1})]),e(P(se),{ref_key:"searchFormRef",ref:h},{default:t(()=>[e(Q,{dense:""},{default:t(()=>[e(U,{cols:"12"},{default:t(()=>[e(he,{modelValue:k.value.license_plate,"onUpdate:modelValue":s[0]||(s[0]=u=>k.value.license_plate=u),autocomplete:"off","bg-color":"white",class:"pr-0",color:"blue-darken-2",density:"compact",placeholder:"請輸入車號",required:"",rules:L.value.carRules,variant:"outlined",onInput:s[1]||(s[1]=u=>k.value.license_plate=k.value.license_plate.toUpperCase())},{"append-inner":t(()=>[e(T,{class:"mr-n3 px-3",color:"blue-darken-3",height:"40",type:"button",variant:"flat",onClick:p},{default:t(()=>[...s[4]||(s[4]=[V(" 查詢 ",-1)])]),_:1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512),v.value&&v.value.license_plate?(o(),y(q,{key:0,class:"pa-2 rounded-lg bg-blue-darken-3 text-center",variant:"flat"},{default:t(()=>[s[5]||(s[5]=n("p",null,"入場資訊",-1)),n("p",qe,d(v.value.license_plate),1),n("p",null,d(v.value.arrival_time),1)]),_:1})):$("",!0),v.value&&v.value.license_plate?(o(),y(q,{key:1,class:"mt-5 pa-2 d-flex flex-column align-center rounded-lg bordered border-md bg-white",variant:"outlined"},{default:t(()=>[s[10]||(s[10]=n("p",{class:"my-4 text-h6"},"應繳金額",-1)),n("p",Me,[s[6]||(s[6]=n("span",{class:"mr-1"},"NT$",-1)),n("span",Oe,d(v.value.paymentAmount),1)]),n("p",Ee,d(f.value?.slipStyle===20?"當次折抵":"折抵時數"),1),n("div",He,[f.value?.slipStyle===18||f.value?.slipStyle===19?(o(!0),F(K,{key:0},G(N.value,(u,C)=>(o(),y(T,{key:C,class:"my-2 mx-1 px-4 text-none rounded-pill",color:i.value===u?"blue-lighten-1":"blue-darken-3",disabled:!R.value||f.value?.remainPoints!==void 0&&f.value?.remainPoints<1,height:"40",type:"button",variant:"flat",onClick:H=>B(u)},{default:t(()=>[V(d(u)+" hr ",1)]),_:2},1032,["color","disabled","onClick"]))),128)):$("",!0),f.value?.slipStyle===19||f.value?.slipStyle===20?(o(),y(T,{key:1,class:"my-2 mx-1 px-4 text-none rounded-pill",color:i.value===24?"blue-lighten-1":"blue-darken-3",disabled:!R.value,height:"40",type:"button",variant:"flat",onClick:s[2]||(s[2]=u=>B(24))},{default:t(()=>[...s[7]||(s[7]=[V(" 24 hr ",-1)])]),_:1},8,["color","disabled"])):$("",!0)]),n("div",Qe,[R.value||f.value?.remainPoints!==void 0&&f.value?.remainPoints>0?(o(),y(T,{key:0,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"red-darken-1",height:"40",variant:"flat",onClick:c},{default:t(()=>[...s[8]||(s[8]=[V(" 折抵 ",-1)])]),_:1})):(o(),y(T,{key:1,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-3",height:"40",variant:"flat",onClick:j},{default:t(()=>[...s[9]||(s[9]=[V(" 回上一頁 ",-1)])]),_:1}))]),z.value.length>0?(o(),y(q,{key:0,class:"my-2 pa-3 rounded-lg bg-grey-lighten-4 w-100",variant:"flat"},{default:t(()=>[e(Q,{dense:""},{default:t(()=>[(o(!0),F(K,null,G(z.value,(u,C)=>(o(),F(K,{key:C},[e(U,{class:"text-grey-darken-1",cols:"8"},{default:t(()=>[V(d(u.vendor_name),1)]),_:2},1024),e(U,{class:"text-grey-darken-1",cols:"4"},{default:t(()=>[V(d(u.amount)+" "+d(u.store_type===1||u.store_type===5?"hr":"NT$"),1)]),_:2},1024)],64))),128))]),_:1})]),_:1})):$("",!0)]),_:1})):$("",!0)])]),_:1})]),_:1}),e(S,{modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=u=>r.value=u),"is-confirm-btn":w.value,message:_.value,"message-title":x.value,onOnClose:E,onPromptConfirm:O},null,8,["modelValue","is-confirm-btn","message","message-title"])])}}}),Je={id:"shopView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},Ke={class:"pt-2 d-flex align-center"},We={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},Ye=te({__name:"shop",setup(X){const M="/RentalDemo/",D=fe(),g=l(null),m=l(null),r=l(!1),x=l(!1),_=l(!1),w=l(""),I=l(""),R=l(!1);function h(a){m.value=a,r.value=!0,a.value==="logout"&&(localStorage.removeItem("memberInfo"),g.value=null)}function k(){m.value=null,r.value=!1}function v(){m.value=null,r.value=!1,D.push("/shopLogin")}function z(){m.value=null,r.value=!1}function L(){_.value=!1}function f(){_.value=!1}function N(){x.value=window.innerWidth<=960}function i(){const a=localStorage.getItem("memberInfo");a?g.value=JSON.parse(a):D.push("/shopLogin")}return le(()=>{i(),N(),window.addEventListener("resize",N)}),me(()=>{window.removeEventListener("resize",N)}),(a,p)=>{const B=xe,c=Xe,j=Fe,O=ie,E=ue,b=ee;return o(),F("div",Je,[ve(e(A,{class:"pb-1 rental rental__wrapper"},{default:t(()=>[e(q,{class:"pa-2",elevation:"4",variant:"elevated"},{default:t(()=>[e(ne,{alt:"Shop Image",color:"surface-variant",cover:"",height:"200",src:`${P(M)}/images/hotel_01.png`,width:"100%"},{default:t(()=>[...p[1]||(p[1]=[n("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},"商店消費停車折抵",-1)])]),_:1},8,["src"]),n("div",Ke,[e(Y,{image:`${P(M)}/images/profile.svg`,size:"30"},null,8,["image"]),n("span",We,d(g.value&&g.value.vendor_name)+" "+d(g.value&&g.value.acc_name)+" 您好！ ",1)])]),_:1}),r.value?$("",!0):(o(),y(B,{key:0,"tab-list":P(we),onSetActiveTab:h},null,8,["tab-list"]))]),_:1},512),[[pe,!x.value||!r.value]]),m.value?.value==="parkingDeduction"&&g.value?(o(),y(A,{key:0,id:"parkingDeduction",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(c,{"active-tab":m.value,"member-info":g.value,onCloseForm:k},null,8,["active-tab","member-info"])]),_:1})):$("",!0),m.value?.value==="search"&&g.value?(o(),y(A,{key:1,id:"search",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(j,{"active-tab":m.value,"member-info":g.value,onCloseForm:k},null,8,["active-tab","member-info"])]),_:1})):$("",!0),m.value?.value==="logout"?(o(),y(A,{key:2,id:"logout",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(O,{"active-tab":m.value,onOnLogin:v},null,8,["active-tab"])]),_:1})):$("",!0),m.value?.value==="changePassword"&&g.value?(o(),y(A,{key:3,id:"changePassword",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(E,{"active-tab":m.value,"user-info":g.value,onOnClose:z},null,8,["active-tab","user-info"])]),_:1})):$("",!0),e(b,{modelValue:_.value,"onUpdate:modelValue":p[0]||(p[0]=s=>_.value=s),"is-confirm-btn":R.value,message:I.value,"message-title":w.value,onOnClose:f,onPromptConfirm:L},null,8,["modelValue","is-confirm-btn","message","message-title"])])}}}),rt=ke(Ye,[["__scopeId","data-v-a036a4d2"]]);export{rt as default};
