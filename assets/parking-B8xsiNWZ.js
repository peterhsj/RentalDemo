import{_ as le,a as oe}from"./Captcha-4hbLIbtb.js";import{_ as ne}from"./PromptDialog.vue_vue_type_script_setup_true_lang-D_4g36MI.js";import{m as D,j as z,l as X,n as q,o as y,f as M,g as se,p as re,q as ie,r as L}from"./index-WgKTUa0E.js";import{l as N,a9 as C,aa as g,ab as t,n as e,v as f,u as U,af as T,a0 as S,r as ue,y as O,ad as Z,Y as H,a5 as ce,k as i,K as de,a3 as fe,S as pe,U as me}from"./vue-core-Bc_tOqtV.js";import{_ as ve,p as ge}from"./site-bz9Keuw1.js";import{a as Q}from"./index-BFZgDbVB.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./date-ui-TtEhfnKH.js";import"./vuetify-ui-EB00uQU6.js";const _e={class:"d-flex flex-column align-center justify-center"},xe={class:"my-4"},be=["innerHTML"],we={class:"d-flex ga-2 flex-wrap justify-center w-100"},ke=N({__name:"InfoView",props:{info:{default:""},infoStatus:{default:"success"}},emits:["info-close","re-write"],setup(P,{emit:I}){const p="/RentalDemo/",o=P,n=I;function V(){n("info-close")}function c(){n("re-write")}return(l,r)=>(g(),C(D,{class:"rental rental__wrapper flex-grow-1"},{default:t(()=>[e(z,{class:"mb-5 pt-5 d-flex flex-column justify-space-between rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[f("div",_e,[f("span",xe,[e(X,{alt:"icon image",cover:"",height:"100%",src:o.infoStatus==="success"?`${U(p)}/images/check.svg`:`${U(p)}/images/warning.svg`,width:"120px"},null,8,["src"])]),f("div",{class:"d-flex flex-column align-center justify-center pa-6",innerHTML:o.info},null,8,be)]),e(D,{class:"py-2"},{default:t(()=>[e(q,{"no-gutters":""},{default:t(()=>[e(y,{cols:"12"},{default:t(()=>[f("div",we,[o.infoStatus!=="error"?(g(),C(M,{key:0,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-3",height:"40",variant:"flat",onClick:V},{default:t(()=>[...r[0]||(r[0]=[S(" 離開 ",-1)])]),_:1})):T("",!0),o.infoStatus==="error"?(g(),C(M,{key:1,class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"orange-darken-3",height:"40",variant:"flat",onClick:c},{default:t(()=>[...r[1]||(r[1]=[S(" 重新輸入 ",-1)])]),_:1})):T("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}}),ye={id:"search",class:"h-100"},Ce={class:"ml-3 text-h6 font-weight-bold text-grey-darken-2"},Ve={style:{width:"120px",height:"40px"}},$e={class:"d-flex ga-2 flex-wrap justify-end w-100"},Fe=N({__name:"ParkingSearchForm",props:{activeTab:{default:()=>({})},formData:{default:()=>({ischeck:0,phone:"",license_plate:"",captcha:""})}},emits:["update:formData","close-form","send-form"],setup(P,{expose:I,emit:p}){const o=P,n=p,V="/RentalDemo/",c=i(null),l=ue(o.formData),r=i({phoneRules:[a=>!!a||"手機號碼為必填",a=>/^\d{10}$/.test(a)||"請輸入有效的手機號碼"],carRules:[a=>!!a||"車號為必填",a=>/^[A-Z0-9]+-[A-Z0-9]+$/.test(a)||"請輸入有效的車號 ( 需包含 - 符號 )"],captchaRules:[a=>!!a||"驗證碼為必填",a=>a===_.value||"請輸入有效的驗證碼"]});O(()=>o.formData,a=>{Object.assign(l,a)},{deep:!0}),O(()=>l,a=>{n("update:formData",a)},{deep:!0});const _=i("");function $(a){_.value=a}async function h(){const{valid:a}=await c.value?.validate()??{valid:!1};a&&n("send-form")}function x(){n("close-form")}function F(){c.value?.reset()}return I({initForm:F}),(a,s)=>{const j=le;return g(),Z("div",ye,[e(z,{class:"rounded-lg bordered border-md bg-white h-100",variant:"outlined"},{default:t(()=>[f("div",{class:"px-4 py-3 d-flex align-center bg-orange-lighten-5 rental__header",onClick:x},[e(se,{class:"mr-2",color:"grey-darken-1",icon:"fa:fas fa-chevron-left",size:"20"}),e(re,{image:`${U(V)}${o.activeTab.icon}`,size:"40"},null,8,["image"]),f("span",Ce,H(o.activeTab.title),1)]),e(U(ie),{ref_key:"parkingFormRef",ref:c,class:"h-100",onSubmit:ce(h,["prevent"])},{default:t(()=>[e(D,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:t(()=>[e(q,{class:"flex-0-1",dense:""},{default:t(()=>[e(y,{cols:"12",md:"6"},{default:t(()=>[e(L,{modelValue:l.phone,"onUpdate:modelValue":s[0]||(s[0]=m=>l.phone=m),autocomplete:"off",color:"blue-darken-2",density:"compact",placeholder:o.activeTab.value==="parking"?"請輸入手機號碼":"請輸入登記手機號碼",required:"",rules:r.value.phoneRules,variant:"outlined"},null,8,["modelValue","placeholder","rules"])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(L,{modelValue:l.license_plate,"onUpdate:modelValue":s[1]||(s[1]=m=>l.license_plate=m),autocomplete:"off",color:"blue-darken-2",density:"compact",placeholder:o.activeTab.value==="parking"?"請輸入車號":"請輸入已登記車號",required:"",rules:r.value.carRules,variant:"outlined",onInput:s[2]||(s[2]=m=>l.license_plate=l.license_plate.toUpperCase())},null,8,["modelValue","placeholder","rules"])]),_:1}),e(y,{class:"py-0",cols:"12"},{default:t(()=>[...s[5]||(s[5]=[f("p",{class:"text-subtitle-1 font-weight-bold"},"驗證碼",-1)])]),_:1}),e(y,{cols:"12",md:"6"},{default:t(()=>[e(L,{modelValue:l.captcha,"onUpdate:modelValue":s[3]||(s[3]=m=>l.captcha=m),autocomplete:"off",color:"blue-darken-2",density:"compact",placeholder:"請輸入驗證碼",required:"",rules:r.value.captchaRules,variant:"outlined",onInput:s[4]||(s[4]=m=>l.captcha=l.captcha.toUpperCase())},{append:t(()=>[f("div",Ve,[e(j,{onSetCaptchaCode:$})])]),_:1},8,["modelValue","rules"])]),_:1}),e(y,{cols:"12"},{default:t(()=>[...s[6]||(s[6]=[f("p",{class:"text-subtitle-2 text-red-darken-1"},[S(" 注意："),f("br"),S(" 更換車號請重新操作，入場當日無法更換登記車號。 ")],-1)])]),_:1})]),_:1}),e(q,{class:"flex-0-1","no-gutters":""},{default:t(()=>[e(y,{class:"mt-4",cols:"12"},{default:t(()=>[f("div",$e,[e(M,{class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"light-green-darken-2",height:"40",type:"submit",variant:"flat"},{default:t(()=>[S(H(o.activeTab.value==="parking"?"登記":"查詢"),1)]),_:1}),e(M,{class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",color:"blue-darken-3",height:"40",variant:"flat",onClick:x},{default:t(()=>[...s[7]||(s[7]=[S(" 離開 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})])}}}),Re={id:"parkingView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},Te=N({__name:"parking",setup(P){const I="/RentalDemo/",p=i(!1),o=i(null),n=i(!1),V=i(!1),c=i(),l=i({ischeck:0,phone:"",license_plate:"",captcha:""}),r=i(!1),_=i(""),$=i(""),h=i(!1),x=i(""),F=i(""),a=i(!1);function s(b){if(b.value==="parkingInfo"){window.open("https://www.grand-hotel.org/TW/official/about-traffic.aspx?gh=TP","_blank");return}o.value=b,n.value=!0}async function j(){const{ischeck:b,phone:u,license_plate:B}=l.value,R={ischeck:b,phone:u,license_plate:B};p.value=!0;const w="/member/grand_hotel/register_cus?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const v=await Q.post(w,R),{returnCode:k,message:d}=v;k===0?m():k===-1?(_.value=`<p class="my-2 text-h4 text-grey-darken-1 font-weight-bold">
            查無登記資訊
          </p>
          <p class="mt-4 mb-7 text-h5 text-amber-darken-3 font-weight-bold text-center">
            請重新確認登記手機號碼或再次輸入
          </p>
          <p class="mt-7 mb-0 text-h5 text-grey-darken-1 text-center">
            另可聯繫飯店客服<br>
            02-1234567
          </p>`,n.value=!1,r.value=!0,$.value="error",c.value?.initForm()):k===3?(x.value="登記手機號碼已有申請車輛",F.value=`${d}`,a.value=!0,h.value=!0):(x.value="訊息通知",F.value=`${d}`,a.value=!1,h.value=!0)}catch(v){console.log({err:v})}finally{p.value=!1}}async function m(){const{phone:b,license_plate:u}=l.value,B={phone:b,license_plate:u};p.value=!0;const R="/member/grand_hotel/select_cus?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const w=await Q.post(R,B),{returnCode:v,message:k,data:d}=w;if(v===0&&d&&d.length>0){const W=d[0];if(W){const{license_plate:ee,reserve_start_date:te,reserve_end_date:ae}=W;n.value=!1,r.value=!0,$.value="success",_.value=`<p class="text-h4 text-grey-darken-1 font-weight-bold my-2">
            已完成登記
          </p>
          <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-3">
            車號
          </p>
          <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
            ${ee}
          </p>
          <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-4">
            停放日期
          </p>
          <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
            ${te} ~ ${ae}
          </p>`,c.value?.initForm()}}else v===-1&&(_.value=`<p class="my-2 text-h4 text-grey-darken-1 font-weight-bold">
            ${k}
          </p>
          <p class="mt-4 mb-7 text-h5 text-amber-darken-3 font-weight-bold text-center">
            請重新確認登記手機號碼或再次輸入
          </p>
          <p class="mt-7 mb-0 text-h5 text-grey-darken-1 text-center">
            另可聯繫飯店客服<br>
            02-1234567
          </p>`,n.value=!1,r.value=!0,$.value="error",c.value?.initForm()),v===3&&(x.value="登記手機號碼已有申請車輛",F.value=`<p>此電話已經申請車號 ${u}，確認是否要覆蓋原有車號？</p>`,a.value=!0,h.value=!0)}catch(w){console.log({err:w})}finally{p.value=!1}}function E(){o.value=null,c.value?.initForm(),n.value=!1}function K(){r.value=!1,n.value=!0}function Y(){r.value=!1,n.value=!1,o.value=null,l.value={ischeck:0,phone:"",license_plate:"",captcha:""}}function G(){l.value.ischeck=1,j()}function J(){h.value=!1}function A(){V.value=window.innerWidth<=960}return de(()=>{A(),window.addEventListener("resize",A)}),fe(()=>{window.removeEventListener("resize",A)}),(b,u)=>{const B=ve,R=Fe,w=ke,v=ne,k=oe;return g(),Z("div",Re,[pe(e(D,{class:"pb-1 rental rental__wrapper"},{default:t(()=>[e(z,{class:"pa-2",elevation:"4",variant:"elevated"},{default:t(()=>[e(X,{alt:"Parking Image",color:"surface-variant",cover:"",height:"200",src:`${U(I)}/images/hotel_01.png`,width:"100%"},{default:t(()=>[...u[3]||(u[3]=[f("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},"住宿車輛登記",-1)])]),_:1},8,["src"])]),_:1}),!n.value&&!r.value?(g(),C(B,{key:0,"tab-list":U(ge),onSetActiveTab:s},null,8,["tab-list"])):T("",!0)]),_:1},512),[[me,(!V.value||!n.value)&&!r.value]]),n.value&&o.value?.value==="parking"?(g(),C(D,{key:0,id:"parking",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(R,{ref_key:"searchFormRef",ref:c,"form-data":l.value,"onUpdate:formData":u[0]||(u[0]=d=>l.value=d),"active-tab":o.value,onCloseForm:E,onSendForm:j},null,8,["form-data","active-tab"])]),_:1})):T("",!0),n.value&&o.value?.value==="search"?(g(),C(D,{key:1,id:"search",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(R,{ref_key:"searchFormRef",ref:c,"form-data":l.value,"onUpdate:formData":u[1]||(u[1]=d=>l.value=d),"active-tab":o.value,onCloseForm:E,onSendForm:m},null,8,["form-data","active-tab"])]),_:1})):T("",!0),r.value?(g(),C(w,{key:2,info:_.value,"info-status":$.value,onInfoClose:Y,onReWrite:K},null,8,["info","info-status"])):T("",!0),e(v,{modelValue:h.value,"onUpdate:modelValue":u[2]||(u[2]=d=>h.value=d),"is-confirm-btn":a.value,message:F.value,"message-title":x.value,onOnClose:J,onPromptConfirm:G},null,8,["modelValue","is-confirm-btn","message","message-title"]),e(k,{overlay:p.value},null,8,["overlay"])])}}}),Le=he(Te,[["__scopeId","data-v-1788239d"]]);export{Le as default};
