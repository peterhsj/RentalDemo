import{h as n,H,a5 as s,ac as M,a7 as f,n as e,ad as a,v as m,V as F,a2 as X,a6 as h,af as C,u as j,Z as b,F as Y,ae as ee,a0 as te,P as ae,Q as le}from"./vue-core-BOLQPpeJ.js";import{_ as J,a as ne,c as oe}from"./PromptDialog-Bkf90FQy.js";import{f as se,i as re,e as ue}from"./date-DE_Uv9Lq.js";import{_ as ie}from"./index-D5whIE8s.js";import"./vuetify-B9nufYXq.js";const S=D=>{if(!D)return"";const i=new Date(D);return se(i,"yyyy-MM-dd")},ce={id:"checkin",class:"h-100"},de={class:"ml-3 text-h6 font-weight-bold text-grey-darken-2"},me={class:"d-flex flex-wrap justify-end w-100"},fe={class:"d-flex justify-space-between w-100"},ve={class:"mt-3 d-flex flex-wrap justify-end w-100"},O={__name:"CheckinForm",props:{activeTab:{type:Object,default:()=>({})}},emits:["closeForm"],setup(D,{emit:i}){const r=D,T=i,c=n(!1),w=n(""),k=n(""),V=n(!1),u=n({startDate:"",endDate:"",carNumber:"",phoneNumber:""}),N=n(null),I=n(),x=n({phoneRules:[t=>!!t||"手機號碼為必填",t=>/^\d{10}$/.test(t)||"請輸入有效的手機號碼"],carRules:[t=>!!t||"車號為必填"],startDateRule:[t=>!!t||"請選擇起始日期",t=>{if(!t||!u.value.endDate)return!0;const l=new Date(t),_=new Date(u.value.endDate);return!l||!_?!0:!ue(l,_)||"起始日期不能晚於結束日期"}],endDateRule:[t=>!!t||"請選擇結束日期",t=>{if(!t||!u.value.startDate)return!0;const l=new Date(u.value.startDate),_=new Date(t);return!l||!_?!0:!re(_,l)||"結束日期不能早於起始日期"}]}),y=n([{id:"p01",phoneNumber:"",carNumber:"ABC-1234",startDate:"2025-10-01",endDate:"2025-10-01"},{id:"p02",phoneNumber:"",carNumber:"DEF-1234",startDate:"2025-10-01",endDate:"2025-10-01"},{id:"p01",phoneNumber:"0912345678",carNumber:"",startDate:"2025-10-01",endDate:"2025-10-01"},{id:"p02",phoneNumber:"0987654321",carNumber:"",startDate:"2025-10-01",endDate:"2025-10-01"}]),p=n([]),d=()=>{r.activeTab.value==="selfCheckIn"?p.value=y.value.filter(t=>t.phoneNumber!==""):r.activeTab.value==="counterCheckIn"&&(p.value=y.value.filter(t=>t.carNumber!==""))};H(()=>{d()});const R=async()=>{const{valid:t}=await I.value.validate();if(!t)return;const{carNumber:l,startDate:_,endDate:z}=u.value;c.value=!0,w.value="無法登記",k.value="本車號已登記，須先刪除原本登記日期後才能再次申請。",V.value=!1},B=t=>{N.value=t,c.value=!0,r.activeTab.value==="counterCheckIn"&&(w.value="刪除登記車號",k.value=`確認刪除 ${t.carNumber} 申請車號？`),r.activeTab.value==="selfCheckIn"&&(w.value="刪除登記手機號碼",k.value=`確認刪除 ${t.phoneNumber} 申請手機號碼？`),V.value=!0},L=()=>{const t=p.value.findIndex(l=>l.id===N.value.id);t!==-1&&p.value.splice(t,1)},g=()=>{T("closeForm")},$=()=>{c.value=!1,L()},Q=()=>{c.value=!1};return(t,l)=>{const _=s("v-icon"),z=s("v-avatar"),E=s("v-text-field"),v=s("v-col"),q=s("v-date-input"),P=s("v-btn"),U=s("v-row"),W=s("v-form"),Z=s("v-list-item"),G=s("v-list"),A=s("v-card"),K=s("v-container");return f(),M("div",ce,[e(A,{variant:"outlined",class:"rounded-lg bordered border-md bg-white h-100"},{default:a(()=>[m("div",{class:"px-4 py-3 d-flex align-center bg-orange-lighten-5 rental__header",onClick:g},[e(_,{icon:"fa:fas fa-chevron-left",size:"20",color:"grey-darken-1",class:"mr-2"}),e(z,{image:r.activeTab.icon,size:"40"},null,8,["image"]),m("span",de,F(r.activeTab.title),1)]),e(K,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:a(()=>[e(W,{ref_key:"checkinFormRef",ref:I,onSubmit:X(R,["prevent"])},{default:a(()=>[e(U,{dense:"",class:"flex-0-1"},{default:a(()=>[r.activeTab.value==="selfCheckIn"?(f(),h(v,{key:0,cols:"12",md:"4"},{default:a(()=>[e(E,{modelValue:u.value.phoneNumber,"onUpdate:modelValue":l[0]||(l[0]=o=>u.value.phoneNumber=o),placeholder:"請輸入登記手機號碼",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2",rules:x.value.phoneRules,required:""},null,8,["modelValue","rules"])]),_:1})):C("",!0),r.activeTab.value==="counterCheckIn"?(f(),h(v,{key:1,cols:"12",md:"4"},{default:a(()=>[e(E,{modelValue:u.value.carNumber,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value.carNumber=o),rules:x.value.carRules,placeholder:"請輸入車號",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules"])]),_:1})):C("",!0),e(v,{cols:"12",md:"4"},{default:a(()=>[e(q,{modelValue:u.value.startDate,"onUpdate:modelValue":l[2]||(l[2]=o=>u.value.startDate=o),rules:x.value.startDateRule,"display-format":j(S),"prepend-icon":"","append-inner-icon":"fa:far fa-calendar-alt",placeholder:"起：2025-10-01",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules","display-format"])]),_:1}),e(v,{cols:"12",md:"4"},{default:a(()=>[e(q,{modelValue:u.value.endDate,"onUpdate:modelValue":l[3]||(l[3]=o=>u.value.endDate=o),rules:x.value.endDateRule,"display-format":j(S),"prepend-icon":"","append-inner-icon":"fa:far fa-calendar-alt",placeholder:"迄：2025-10-01",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules","display-format"])]),_:1}),e(v,{cols:"12"},{default:a(()=>[m("div",me,[e(P,{type:"submit",color:"light-green-darken-2",variant:"flat",class:"px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40"},{default:a(()=>[...l[5]||(l[5]=[b(" 登記 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1},512),e(A,{variant:"outlined",class:"mt-5 pa-2 rounded-lg bordered border-md bg-white flex-grow-1 overflow-y-auto"},{default:a(()=>[e(G,null,{default:a(()=>[(f(!0),M(Y,null,ee(p.value,(o,ge)=>(f(),h(Z,{class:"py-2",key:o.id},{default:a(()=>[m("div",fe,[e(U,{"no-gutters":"",class:"flex-grow-1"},{default:a(()=>[e(v,{cols:"12",md:"4",class:"text-h5 font-weight-bold text-grey-darken-1"},{default:a(()=>[b(F(r.activeTab.value==="counterCheckIn"?o.carNumber:o.phoneNumber),1)]),_:2},1024),e(v,{cols:"12",md:"4",class:"rental-subtitle-1 text-blue-darken-3"},{default:a(()=>[b(F(o.startDate),1)]),_:2},1024),e(v,{cols:"12",md:"4",class:"rental-subtitle-1 text-blue-darken-3"},{default:a(()=>[b(F(o.endDate),1)]),_:2},1024)]),_:2},1024),m("div",null,[e(P,{density:"comfortable",variant:"flat",icon:"fa:fas fa-times-circle",class:"text-red-darken-1",onClick:he=>B(o)},null,8,["onClick"])])])]),_:2},1024))),128))]),_:1})]),_:1}),e(U,{"no-gutters":"",class:"flex-0-1"},{default:a(()=>[e(v,{cols:"12"},{default:a(()=>[m("div",ve,[e(P,{color:"blue-darken-3",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:g},{default:a(()=>[...l[6]||(l[6]=[b(" 完成離開 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),e(J,{modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=o=>c.value=o),message:k.value,messageTitle:w.value,isConfirmBtn:V.value,onPromptConfirm:$,onOnClose:Q},null,8,["modelValue","message","messageTitle","isConfirmBtn"])])}}},pe={id:"parkingView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},_e={class:"pt-2 d-flex align-center"},be={__name:"CounterView",setup(D){const i=n({}),r=n(!1),T=n(!1),c=n(!1),w=n(""),k=n(""),V=n(!1),u=p=>{i.value=p,r.value=!0,console.log("tab",i)},N=()=>{i.value={},console.log("close form",i.value),r.value=!1},I=()=>{c.value=!1,isInfo.value=!0,infoStatus.value="success",initForm()},x=()=>{c.value=!1},y=()=>{T.value=window.innerWidth<=960};return H(()=>{y(),window.addEventListener("resize",y)}),te(()=>{window.removeEventListener("resize",y)}),(p,d)=>{const R=s("v-img"),B=s("v-avatar"),L=s("v-card"),g=s("v-container");return f(),M("div",pe,[ae(e(g,{class:"pb-1 rental rental__wrapper"},{default:a(()=>[e(L,{variant:"elevated",elevation:"4",class:"pa-2"},{default:a(()=>[e(R,{color:"surface-variant",height:"200",width:"100%",src:"/public/images/hotel_01.png",cover:"",alt:"Parking Image"},{default:a(()=>[...d[1]||(d[1]=[m("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},[b("住宿車輛"),m("br"),b("預約及臨櫃登記")],-1)])]),_:1}),m("div",_e,[e(B,{image:"/public/images/profile.svg",size:"30"}),d[2]||(d[2]=m("span",{class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"}," John Doe 您好！ ",-1))])]),_:1}),r.value?C("",!0):(f(),h(ne,{key:0,tabList:j(oe),onSetActiveTab:u},null,8,["tabList"]))]),_:1},512),[[le,!T.value||!r.value]]),i.value.value==="counterCheckIn"?(f(),h(g,{key:0,id:"counterCheckIn",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:a(()=>[e(O,{ref:"searchFormRef",activeTab:i.value,onCloseForm:N},null,8,["activeTab"])]),_:1})):C("",!0),i.value.value==="selfCheckIn"?(f(),h(g,{key:1,id:"selfCheckIn",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:a(()=>[e(O,{ref:"searchFormRef",activeTab:i.value,onCloseForm:N},null,8,["activeTab"])]),_:1})):C("",!0),i.value.value==="parkingInfo"?(f(),h(g,{key:2,id:"parkingInfo",class:"rental rental__wrapper"},{default:a(()=>[...d[3]||(d[3]=[b(" parkingInfo ",-1)])]),_:1})):C("",!0),e(J,{modelValue:c.value,"onUpdate:modelValue":d[0]||(d[0]=$=>c.value=$),message:k.value,messageTitle:w.value,isConfirmBtn:V.value,onPromptConfirm:I,onOnClose:x},null,8,["modelValue","message","messageTitle","isConfirmBtn"])])}}},De=ie(be,[["__scopeId","data-v-e3bc1f1f"]]);export{De as default};
