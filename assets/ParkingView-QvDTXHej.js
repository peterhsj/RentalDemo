import{h as i,r as J,y as Z,a5 as n,ac as Q,a7 as x,n as e,ad as t,v as p,u as I,V as H,a2 as K,Z as R,a6 as $,af as V,H as Y,a0 as ee,P as te,Q as ae}from"./vue-core-CsbKmrRr.js";import{_ as oe,p as le}from"./TabList-C060IOAN.js";import{a as X}from"./index-BFZgDbVB.js";import{C as ne,_ as se}from"./CommonOverlay-DTO2ZyYC.js";import{_ as re}from"./PromptDialog-TYGxE2y4.js";import{_ as ce}from"./index-BgiTuXJI.js";import"./vuetify-CHkSyw28.js";import"./date-DE_Uv9Lq.js";const ie={id:"search",class:"h-100"},ue={class:"ml-3 text-h6 font-weight-bold text-grey-darken-2"},de={style:{width:"120px",height:"40px"}},pe={class:"d-flex ga-2 flex-wrap justify-end w-100"},G={__name:"SearchForm",props:{activeTab:{type:Object,default:()=>({})},formData:{type:Object,default:()=>({})}},emits:["update:formData","closeForm","sendForm"],setup(y,{expose:T,emit:_}){const l=y,s=_,C="https://peterhsj.github.io/RentalDemo",m=i(),a=J(l.formData),c=i({phoneRules:[o=>!!o||"手機號碼為必填",o=>/^\d{10}$/.test(o)||"請輸入有效的手機號碼"],carRules:[o=>!!o||"車號為必填",o=>/^[A-Z0-9]+-[A-Z0-9]+$/.test(o)||"請輸入有效的車號 ( 需包含 - 符號 )"],captchaRules:[o=>!!o||"驗證碼為必填",o=>o===f.value||"請輸入有效的驗證碼"]});Z(()=>l.formData,o=>{Object.assign(a,o)},{deep:!0}),Z(()=>a,o=>{s("update:formData",o)},{deep:!0});const f=i(""),b=o=>{f.value=o},g=async()=>{const{valid:o}=await m.value.validate();o&&s("sendForm")},h=()=>{s("closeForm")};return T({initForm:()=>{m.value.reset()}}),(o,r)=>{const z=n("v-icon"),A=n("v-avatar"),S=n("v-text-field"),F=n("v-col"),M=n("v-row"),N=n("v-btn"),W=n("v-container"),q=n("v-form"),B=n("v-card");return x(),Q("div",ie,[e(B,{variant:"outlined",class:"rounded-lg bordered border-md bg-white h-100"},{default:t(()=>[p("div",{class:"px-4 py-3 d-flex align-center bg-orange-lighten-5 rental__header",onClick:h},[e(z,{icon:"fa:fas fa-chevron-left",size:"20",color:"grey-darken-1",class:"mr-2"}),e(A,{image:`${I(C)}${l.activeTab.icon}`,size:"40"},null,8,["image"]),p("span",ue,H(l.activeTab.title),1)]),e(q,{ref_key:"parkingFormRef",ref:m,class:"h-100",onSubmit:K(g,["prevent"])},{default:t(()=>[e(W,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:t(()=>[e(M,{dense:"",class:"flex-0-1"},{default:t(()=>[e(F,{cols:"12",md:"6"},{default:t(()=>[e(S,{modelValue:a.phone,"onUpdate:modelValue":r[0]||(r[0]=u=>a.phone=u),placeholder:l.activeTab.value==="parking"?"請輸入手機號碼":"請輸入登記手機號碼",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2",rules:c.value.phoneRules,required:""},null,8,["modelValue","placeholder","rules"])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(S,{modelValue:a.license_plate,"onUpdate:modelValue":r[1]||(r[1]=u=>a.license_plate=u),placeholder:l.activeTab.value==="parking"?"請輸入車號":"請輸入已登記車號",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2",rules:c.value.carRules,onInput:r[2]||(r[2]=u=>a.license_plate=a.license_plate.toUpperCase()),required:""},null,8,["modelValue","placeholder","rules"])]),_:1}),e(F,{cols:"12",class:"py-0"},{default:t(()=>[...r[5]||(r[5]=[p("p",{class:"text-subtitle-1 font-weight-bold"},"驗證碼",-1)])]),_:1}),e(F,{cols:"12",md:"6"},{default:t(()=>[e(S,{modelValue:a.captcha,"onUpdate:modelValue":r[3]||(r[3]=u=>a.captcha=u),placeholder:"請輸入驗證碼",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2",rules:c.value.captchaRules,onInput:r[4]||(r[4]=u=>a.captcha=a.captcha.toUpperCase()),required:""},{append:t(()=>[p("div",de,[e(ne,{onSetCaptchaCode:b})])]),_:1},8,["modelValue","rules"])]),_:1}),e(F,{cols:"12"},{default:t(()=>[...r[6]||(r[6]=[p("p",{class:"text-subtitle-2 text-red-darken-1"},[R(" 注意："),p("br"),R(" 更換車號請重新操作，入場當日無法更換登記車號。 ")],-1)])]),_:1})]),_:1}),e(M,{"no-gutters":"",class:"flex-0-1"},{default:t(()=>[e(F,{cols:"12",class:"mt-4"},{default:t(()=>[p("div",pe,[e(N,{type:"submit",color:"light-green-darken-2",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40"},{default:t(()=>[R(H(l.activeTab.value==="parking"?"登記":"查詢"),1)]),_:1}),e(N,{color:"blue-darken-3",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:h},{default:t(()=>[...r[7]||(r[7]=[R(" 離開 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})])}}},me={id:"parkingInfo",class:"h-100"},fe={class:"ml-3 text-h6 font-weight-bold text-grey-darken-2"},ve={__name:"ParkingInfo",props:{activeTab:{type:Object,default:()=>({})}},emits:["closeForm"],setup(y,{emit:T}){const _="https://peterhsj.github.io/RentalDemo",l=y,s=T,C=()=>{s("closeForm")};return(m,a)=>{const c=n("v-icon"),f=n("v-avatar"),b=n("v-col"),g=n("v-row"),h=n("v-container"),k=n("v-card");return x(),Q("div",me,[e(k,{variant:"outlined",class:"rounded-lg bordered border-md bg-white h-100"},{default:t(()=>[p("div",{class:"px-4 py-3 d-flex align-center bg-orange-lighten-5 rental__header",onClick:C},[e(c,{icon:"fa:fas fa-chevron-left",size:"20",color:"grey-darken-1",class:"mr-2"}),e(f,{image:`${I(_)}${l.activeTab.icon}`,size:"40"},null,8,["image"]),p("span",fe,H(l.activeTab.title),1)]),e(h,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:t(()=>[e(g,{dense:"",class:"flex-0-1"},{default:t(()=>[e(b,{cols:"12",md:"6"},{default:t(()=>[...a[0]||(a[0]=[R(" ParkingInfo ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])}}},_e={class:"d-flex flex-column align-center justify-center"},ge={class:"my-4"},he=["innerHTML"],be={class:"d-flex ga-2 flex-wrap justify-center w-100"},xe={__name:"InfoView",props:{info:{type:String,default:""},infoStatus:{type:String,default:"success"}},emits:["infoClose","reWrite"],setup(y,{emit:T}){const _="https://peterhsj.github.io/RentalDemo",l=T,s=()=>{l("infoClose")},C=()=>{l("reWrite")};return(m,a)=>{const c=n("v-img"),f=n("v-btn"),b=n("v-col"),g=n("v-row"),h=n("v-container"),k=n("v-card");return x(),$(h,{class:"rental rental__wrapper flex-grow-1"},{default:t(()=>[e(k,{variant:"outlined",class:"mb-5 pt-5 d-flex flex-column justify-space-between rounded-lg bordered border-md bg-white h-100"},{default:t(()=>[p("div",_e,[p("span",ge,[e(c,{height:"100%",width:"120px",src:y.infoStatus==="success"?`${I(_)}/images/check.svg`:`${I(_)}/images/warning.svg`,cover:"",alt:"icon image"},null,8,["src"])]),p("div",{class:"d-flex flex-column align-center justify-center pa-6",innerHTML:y.info},null,8,he)]),e(h,{class:"py-2"},{default:t(()=>[e(g,{"no-gutters":""},{default:t(()=>[e(b,{cols:"12"},{default:t(()=>[p("div",be,[y.infoStatus!=="error"?(x(),$(f,{key:0,color:"blue-darken-3",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:s},{default:t(()=>[...a[0]||(a[0]=[R(" 離開 ",-1)])]),_:1})):V("",!0),y.infoStatus==="error"?(x(),$(f,{key:1,color:"orange-darken-3",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:C},{default:t(()=>[...a[1]||(a[1]=[R(" 重新輸入 ",-1)])]),_:1})):V("",!0)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},we={id:"parkingView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},ye={__name:"ParkingView",setup(y){const T="https://peterhsj.github.io/RentalDemo",_=i(!1),l=i({}),s=i(!1),C=i(!1),m=i(),a=i({ischeck:0,phone:"",license_plate:"",captcha:""}),c=i(!1),f=i(""),b=i(""),g=i(!1),h=i(""),k=i(""),o=i(!1),r=u=>{l.value=u,s.value=!0},z=async()=>{const{ischeck:u,phone:v,license_plate:D}=a.value,U={ischeck:u,phone:v,license_plate:D};console.log("提交表單",U),_.value=!0;const w="/member/grand_hotel/register_cus?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const d=await X.post(w,U),{returnCode:P,message:j,data:L}=d;if(P===0){console.log("登入成功",L);const{license_plate:O,parking_date:E}=L;s.value=!1,c.value=!0,b.value="success",f.value=`<p class="text-h4 text-grey-darken-1 font-weight-bold my-2">
          已完成登記
        </p>
        <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-3">
          車號
        </p>
        <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
          ${O}
        </p>
        <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-4">
          停放日期
        </p>
        <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
          ${E}
        </p>`,m.value.initForm()}else P===-1?(f.value=`<p class="my-2 text-h4 text-grey-darken-1 font-weight-bold">
            查無登記資訊
          </p>
          <p class="mt-4 mb-7 text-h5 text-amber-darken-3 font-weight-bold text-center">
            請重新確認登記手機號碼或再次輸入
          </p>
          <p class="mt-7 mb-0 text-h5 text-grey-darken-1 text-center">
            另可聯繫飯店客服<br>
            02-1234567
          </p>`,s.value=!1,c.value=!0,b.value="error",m.value.initForm()):P===3?(h.value="登記手機號碼已有申請車輛",k.value=`${j}`,o.value=!0,g.value=!0):(h.value="訊息通知",k.value=`${j}`,o.value=!1,g.value=!0)}catch(d){console.log({err:d})}finally{_.value=!1}},A=async()=>{const{phone:u,license_plate:v}=a.value,D={phone:u,license_plate:v};console.log("提交表單",D),_.value=!0;const U="/member/grand_hotel/select_cus?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const w=await X.post(U,D),{returnCode:d,message:P,data:j}=w;if(console.log("data",d,P,j),d===0){console.log("登入成功",j);const{license_plate:L,reserve_start_date:O,reserve_end_date:E}=j[0];s.value=!1,c.value=!0,b.value="success",f.value=`<p class="text-h4 text-grey-darken-1 font-weight-bold my-2">
          已完成登記
        </p>
        <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-3">
          車號
        </p>
        <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
          ${L}
        </p>
        <p class="rental__text--h45 text-grey-darken-1 font-weight-bold mt-4">
          停放日期
        </p>
        <p class="text-h5 text-amber-darken-3 font-weight-bold my-0">
          ${O} ~ ${E}
        </p>`,m.value.initForm()}else d===-1&&(f.value=`<p class="my-2 text-h4 text-grey-darken-1 font-weight-bold">
            查無登記資訊
          </p>
          <p class="mt-4 mb-7 text-h5 text-amber-darken-3 font-weight-bold text-center">
            請重新確認登記手機號碼或再次輸入
          </p>
          <p class="mt-7 mb-0 text-h5 text-grey-darken-1 text-center">
            另可聯繫飯店客服<br>
            02-1234567
          </p>`,s.value=!1,c.value=!0,b.value="error",m.value.initForm()),d===3&&(h.value="登記手機號碼已有申請車輛",k.value=`<p>此電話已經申請車號 ${v}，確認是否要覆蓋原有車號？</p>`,o.value=!0,g.value=!0)}catch(w){console.log({err:w})}finally{_.value=!1}},S=()=>{l.value={},m.value.initForm(),s.value=!1},F=()=>{l.value={},s.value=!1},M=()=>{c.value=!1,s.value=!0},N=()=>{c.value=!1,s.value=!1,l.value={},a.value={phoneNumber:"",carNumber:"",captcha:""}},W=()=>{a.value.ischeck=1,z()},q=()=>{g.value=!1},B=()=>{C.value=window.innerWidth<=960};return Y(()=>{B(),window.addEventListener("resize",B)}),ee(()=>{window.removeEventListener("resize",B)}),(u,v)=>{const D=n("v-img"),U=n("v-card"),w=n("v-container");return x(),Q("div",we,[te(e(w,{class:"pb-1 rental rental__wrapper"},{default:t(()=>[e(U,{variant:"elevated",elevation:"4",class:"pa-2"},{default:t(()=>[e(D,{color:"surface-variant",height:"200",width:"100%",src:`${I(T)}/images/hotel_01.png`,cover:"",alt:"Parking Image"},{default:t(()=>[...v[3]||(v[3]=[p("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},"住宿車輛登記",-1)])]),_:1},8,["src"])]),_:1}),!s.value&&!c.value?(x(),$(oe,{key:0,tabList:I(le),onSetActiveTab:r},null,8,["tabList"])):V("",!0)]),_:1},512),[[ae,(!C.value||!s.value)&&!c.value]]),s.value&&l.value.value==="parking"?(x(),$(w,{key:0,id:"parking",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(G,{ref_key:"searchFormRef",ref:m,formData:a.value,"onUpdate:formData":v[0]||(v[0]=d=>a.value=d),activeTab:l.value,onCloseForm:S,onSendForm:z},null,8,["formData","activeTab"])]),_:1})):V("",!0),s.value&&l.value.value==="search"?(x(),$(w,{key:1,id:"search",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(G,{ref_key:"searchFormRef",ref:m,formData:a.value,"onUpdate:formData":v[1]||(v[1]=d=>a.value=d),activeTab:l.value,onCloseForm:S,onSendForm:A},null,8,["formData","activeTab"])]),_:1})):V("",!0),s.value&&l.value.value==="parkingInfo"?(x(),$(w,{key:2,id:"parkingInfo",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(ve,{activeTab:l.value,onCloseForm:F},null,8,["activeTab"])]),_:1})):V("",!0),c.value?(x(),$(xe,{key:3,infoStatus:b.value,info:f.value,onInfoClose:N,onReWrite:M},null,8,["infoStatus","info"])):V("",!0),e(re,{modelValue:g.value,"onUpdate:modelValue":v[2]||(v[2]=d=>g.value=d),message:k.value,messageTitle:h.value,isConfirmBtn:o.value,onPromptConfirm:W,onOnClose:q},null,8,["modelValue","message","messageTitle","isConfirmBtn"]),e(se,{overlay:_.value},null,8,["overlay"])])}}},De=ce(ye,[["__scopeId","data-v-fbcfb840"]]);export{De as default};
