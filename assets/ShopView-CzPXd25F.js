import{h as a,H as te,a5 as n,ac as z,a7 as r,n as e,ad as t,v as s,u as M,V as d,a6 as x,af as D,Z as T,F as W,ae as Y,a2 as le,a0 as oe,P as se,Q as ne,ah as re}from"./vue-core-CsbKmrRr.js";import{_ as ie,s as ue}from"./TabList-C060IOAN.js";import{a as Z}from"./index-BFZgDbVB.js";import{_ as ee}from"./PromptDialog-TYGxE2y4.js";import{f as J,_ as ce,C as de}from"./ChangePassword-C4MWdfe2.js";import{i as me,e as ve}from"./date-DE_Uv9Lq.js";import{_ as fe}from"./index-GIYZ2hrt.js";import"./vuetify-CHkSyw28.js";const pe={id:"parkingDeduction",class:"h-100"},_e={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},ge={class:"flex-grow-1 overflow-hidden overflow-y-auto"},he={class:"d-flex justify-center my-8"},be={key:0},ye={key:1,class:"text-h3"},xe={class:"py-2 text-h6 font-weight-bold"},we={class:"my-1"},ke={class:"text-h3 font-weight-bold"},Ce={class:"my-4 text-h6"},$e={class:"ma-4 d-flex align-center justify-space-around w-100"},Ie={class:"mt-3 d-flex flex-wrap justify-center w-100"},Ve={__name:"ParkingDeduction",props:{activeTab:{type:Object,default:()=>({})},memberInfo:{type:Object,default:()=>({})}},emits:["closeForm"],setup(E,{emit:H}){const R=E,$=H,m="https://peterhsj.github.io/RentalDemo",i=a(!1),I=a(""),w=a(""),S=a(!1),U=a(!1),j=a(!1),h=a(),V=a({license_plate:""}),f=a({}),L=a([]),O=a({carRules:[v=>!!v||"車號為必填"]}),p=a({}),A=a([]),u=a(null),l=async()=>{const v={id:R.memberInfo.vendorId};U.value=!0;const o="/member/grand_hotel/get_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const y=await Z.post(o,v),{returnCode:N,message:g,data:F}=y;N===0?(p.value=F[0],A.value=F[0].slipHour.split(",").map(c=>Number(c))):(I.value="訊息通知",w.value=`${g}`,S.value=!1,i.value=!0)}catch(y){console.log({err:y})}finally{U.value=!1}};te(async()=>{await l()}),a([]);const _=async()=>{const{valid:v}=await h.value.validate();if(!v)return;const{license_plate:o}=V.value,y={license_plate:o};U.value=!0;const N="/member/grand_hotel/car_in_park_sel?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const g=await Z.post(N,y),{returnCode:F,message:c,data:Q,discount:G}=g;F===0?(f.value=Q,L.value=G,j.value=Q.ischeck===0):(I.value="訊息通知",w.value=`${c}`,S.value=!1,i.value=!0)}catch(g){console.log({err:g})}finally{U.value=!1}},P=v=>{u.value=v},k=async()=>{if(!u.value){I.value="訊息通知",w.value="請選擇折抵時數",S.value=!1,i.value=!0;return}const v={vendorId:p.value.vendorId,store_type:p.value.store_type,license_plate:V.value.license_plate,count:u.value};U.value=!0;const o="/member/grand_hotel/register_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const y=await Z.post(o,v),{returnCode:N,message:g,data:F}=y;N===0?(await l(),h.value.reset(),f.value={},L.value=[],u.value=null,j.value=!1,I.value="訊息通知",w.value=`${g}`,S.value=!1,i.value=!0):(I.value="訊息通知",w.value=`${g}`,S.value=!1,i.value=!0)}catch(y){console.log({err:y})}finally{U.value=!1}},B=()=>{$("closeForm")},b=()=>{i.value=!1,delParkingConfirm()},q=()=>{i.value=!1};return(v,o)=>{const y=n("v-icon"),N=n("v-avatar"),g=n("v-btn"),F=n("v-text-field"),c=n("v-col"),Q=n("v-row"),G=n("v-form"),X=n("v-card"),ae=n("v-container");return r(),z("div",pe,[e(X,{variant:"outlined",class:"rounded-lg bordered border-md bg-white h-100"},{default:t(()=>[s("div",{class:"px-4 py-3 d-flex align-center rental__header bg-orange-lighten-5",onClick:B},[e(y,{icon:"fa:fas fa-chevron-left",size:"20",color:"grey-darken-1",class:"mr-2"}),e(N,{image:`${M(m)}/images/profile.svg`,size:"30"},null,8,["image"]),s("span",_e,d(R.memberInfo.vendor_name)+" [ "+d(R.memberInfo.acc_name)+" ] ",1)]),e(ae,{class:"pb-2 d-flex flex-column",style:{height:"calc(100% - 64px)"}},{default:t(()=>[s("div",ge,[s("div",he,[e(N,{color:"blue-darken-3",size:"170"},{default:t(()=>[p.value.remainPoints==="-1"?(r(),z("span",be,[e(y,{icon:"fa:fas fa-infinity",size:"80",class:""})])):(r(),z("span",ye,d(p.value.remainPoints),1))]),_:1})]),e(G,{ref_key:"formRef",ref:h},{default:t(()=>[e(Q,{dense:""},{default:t(()=>[e(c,{cols:"12"},{default:t(()=>[e(F,{modelValue:V.value.license_plate,"onUpdate:modelValue":o[0]||(o[0]=C=>V.value.license_plate=C),rules:O.value.carRules,placeholder:"請輸入車號",autocomplete:"off",variant:"outlined",density:"compact",color:"blue-darken-2",class:"pr-0","bg-color":"white",onInput:o[1]||(o[1]=C=>V.value.license_plate=V.value.license_plate.toUpperCase()),required:""},{"append-inner":t(()=>[e(g,{type:"button",color:"blue-darken-3",variant:"flat",class:"mr-n3 px-3",height:"40",onClick:_},{default:t(()=>[...o[4]||(o[4]=[T(" 查詢 ",-1)])]),_:1})]),_:1},8,["modelValue","rules"])]),_:1})]),_:1})]),_:1},512),f.value&&f.value.license_plate?(r(),x(X,{key:0,variant:"flat",class:"pa-2 rounded-lg bg-blue-darken-3 text-center"},{default:t(()=>[o[5]||(o[5]=s("p",null,"入場資訊",-1)),s("p",xe,d(f.value.license_plate),1),s("p",null,d(f.value.arrival_time),1)]),_:1})):D("",!0),f.value&&f.value.license_plate?(r(),x(X,{key:1,variant:"outlined",class:"mt-5 pa-2 d-flex flex-column align-center rounded-lg bordered border-md bg-white"},{default:t(()=>[o[10]||(o[10]=s("p",{class:"my-4 text-h6"},"應繳金額",-1)),s("p",we,[o[6]||(o[6]=s("span",{class:"mr-1"},"NT$",-1)),s("span",ke,d(f.value.paymentAmount),1)]),s("p",Ce,d(p.value.slipStyle===20?"當次折抵":"折抵時數"),1),s("div",$e,[p.value.slipStyle===18||p.value.slipStyle===19?(r(!0),z(W,{key:0},Y(A.value,(C,K)=>(r(),x(g,{key:K,type:"button",color:u.value===C?"blue-lighten-1":"blue-darken-3",variant:"flat",class:"my-2 mx-1 px-4 text-none rounded-pill",height:"40",disabled:!j.value||p.value.remainPoints<1,onClick:qe=>P(C)},{default:t(()=>[T(d(C)+" hr ",1)]),_:2},1032,["color","disabled","onClick"]))),128)):D("",!0),p.value.slipStyle===19||p.value.slipStyle===20?(r(),x(g,{key:1,type:"button",color:u.value===24?"blue-lighten-1":"blue-darken-3",variant:"flat",class:"my-2 mx-1 px-4 text-none rounded-pill",height:"40",disabled:!j.value,onClick:o[2]||(o[2]=C=>P(24))},{default:t(()=>[...o[7]||(o[7]=[T(" 24 hr ",-1)])]),_:1},8,["color","disabled"])):D("",!0)]),s("div",Ie,[j.value||p.value.remainPoints>0?(r(),x(g,{key:0,color:"red-darken-1",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:k},{default:t(()=>[...o[8]||(o[8]=[T(" 折抵 ",-1)])]),_:1})):(r(),x(g,{key:1,color:"blue-darken-3",variant:"flat",class:"my-2 px-8 w-100 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:B},{default:t(()=>[...o[9]||(o[9]=[T(" 回上一頁 ",-1)])]),_:1}))]),L.value.length>0?(r(),x(X,{key:0,variant:"flat",class:"my-2 pa-3 rounded-lg bg-grey-lighten-4 w-100"},{default:t(()=>[e(Q,{dense:""},{default:t(()=>[(r(!0),z(W,null,Y(L.value,(C,K)=>(r(),z(W,{key:K},[e(c,{cols:"8",class:"text-grey-darken-1"},{default:t(()=>[T(d(C.vendor_name),1)]),_:2},1024),e(c,{cols:"4",class:"text-grey-darken-1"},{default:t(()=>[T(d(C.amount)+" "+d(C.store_type===1||C.store_type===5?"hr":"NT$"),1)]),_:2},1024)],64))),128))]),_:1})]),_:1})):D("",!0)]),_:1})):D("",!0)])]),_:1})]),_:1}),e(ee,{modelValue:i.value,"onUpdate:modelValue":o[3]||(o[3]=C=>i.value=C),message:w.value,messageTitle:I.value,isConfirmBtn:S.value,onPromptConfirm:b,onOnClose:q},null,8,["modelValue","message","messageTitle","isConfirmBtn"])])}}},Te={id:"checkin",class:"h-100"},De={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},Se={class:"d-flex justify-end w-100"},Ue={class:"w-25 w-sm-auto text-center"},Be={class:"mt-3 ga-2 d-flex justify-md-end flex-nowrap"},Re={class:"d-flex justify-space-between w-100"},je={class:"pl-4 pt-2 mt-2 mr-1 rounded-te-xl bg-blue-darken-3 text-subtitle-1",style:{height:"40px"}},Ne={class:"d-flex flex-column flex-md-row flex-lg-row justify-start",style:{"line-height":"1.4"}},Fe={class:"text-body-2 text-no-wrap w-100 w-md-50"},Pe={class:"text-body-2 text-no-wrap w-100 w-md-50"},ze={__name:"SearchForm",props:{activeTab:{type:Object,default:()=>({})},memberInfo:{type:Object,default:()=>({})}},emits:["closeForm"],setup(E,{emit:H}){const R=E,$=H,m="https://peterhsj.github.io/RentalDemo",i=a(!1),I=a(""),w=a(""),S=a(!1),U=a(!1),j=a(),h=a({start_time:"",end_time:""}),V=a({startDateRule:[u=>!!u||"請選擇起始日期",u=>{if(!u||!h.value.end_time)return!0;const l=new Date(u),_=new Date(h.value.end_time);return!l||!_?!0:!ve(l,_)||"起始日期不能晚於結束日期"}],endDateRule:[u=>!!u||"請選擇結束日期",u=>{if(!u||!h.value.start_time)return!0;const l=new Date(h.value.start_time),_=new Date(u);return!l||!_?!0:!me(_,l)||"結束日期不能早於起始日期"}]});a([]);const f=a([]);a([{id:"p01",type:"counter",rvDate:"2025-10-01",carNumber:"ABC-1234",phoneNumber:"0912345678",startDate:"2025-10-09",endDate:"2025-10-10"}]);const L=async()=>{const{valid:u}=await j.value.validate();if(!u)return;const{start_time:l,end_time:_}=h.value,P={vendorId:R.memberInfo.vendorId,start_time:J(l),end_time:J(_)};console.log("payload",P),U.value=!0;const k="/member/grand_hotel/select_store?bQz0fX8f=4ApR34x2wb2CVTNUfsq3";try{const B=await Z.post(k,P),{returnCode:b,message:q,data:v}=B;b===0?(console.log("data",v),f.value=v):(I.value="訊息通知",w.value=`${q}`,S.value=!1,i.value=!0)}catch(B){console.log({err:B})}finally{U.value=!1}},O=()=>{$("closeForm")},p=()=>{i.value=!1},A=()=>{i.value=!1};return(u,l)=>{const _=n("v-icon"),P=n("v-avatar"),k=n("v-col"),B=n("v-date-input"),b=n("v-btn"),q=n("v-img"),v=n("v-row"),o=n("v-form"),y=n("v-container"),N=n("v-list-item"),g=n("v-list"),F=n("v-card");return r(),z("div",Te,[e(F,{variant:"outlined",class:"rounded-lg bordered border-md bg-white h-100"},{default:t(()=>[s("div",{class:"px-4 py-3 d-flex align-center rental__header bg-orange-lighten-5",onClick:O},[e(_,{icon:"fa:fas fa-chevron-left",size:"20",color:"grey-darken-1",class:"mr-2"}),e(P,{image:`${M(m)}/images/profile.svg`,size:"30"},null,8,["image"]),s("span",De,d(R.memberInfo.vendor_name)+" [ "+d(R.memberInfo.acc_name)+" ] ",1)]),e(y,{class:"pb-2 d-flex flex-column justify-space-between",style:{height:"calc(100% - 64px)"}},{default:t(()=>[e(o,{ref_key:"searchFormRef",ref:j},{default:t(()=>[e(v,{dense:"",class:"flex-0-1"},{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[...l[3]||(l[3]=[s("p",{class:"mt-1 mb-2 text-h6 text-blue-darken-3 text-center text-md-left"}," 折抵記錄查詢 ",-1)])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(B,{modelValue:h.value.start_time,"onUpdate:modelValue":l[0]||(l[0]=c=>h.value.start_time=c),rules:V.value.startDateRule,"display-format":M(J),"prepend-icon":"","append-inner-icon":"fa:far fa-calendar-alt",placeholder:"起：2026-01-01",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules","display-format"])]),_:1}),e(k,{cols:"12",md:"4"},{default:t(()=>[e(B,{modelValue:h.value.end_time,"onUpdate:modelValue":l[1]||(l[1]=c=>h.value.end_time=c),rules:V.value.endDateRule,"display-format":M(J),"prepend-icon":"","append-inner-icon":"fa:far fa-calendar-alt",placeholder:"迄：2026-01-01",variant:"outlined",density:"compact",color:"blue-darken-2","bg-color":"white",required:""},null,8,["modelValue","rules","display-format"])]),_:1}),e(k,{cols:"12"},{default:t(()=>[s("div",Se,[e(b,{color:"blue-darken-2",variant:"flat",class:"px-8 w-75 w-sm-auto rounded-lg text-h6 font-weight-regular",height:"40",onClick:le(L,["prevent"])},{default:t(()=>[...l[4]||(l[4]=[T(" 查詢 ",-1)])]),_:1}),s("div",Ue,[e(b,{color:"blue-darken-2",variant:"text",class:"px-2",height:"40"},{default:t(()=>[e(q,{height:"30",width:"35",src:`${M(m)}/images/ktorrent.svg`,cover:"",alt:"icon"},null,8,["src"])]),_:1})])])]),_:1})]),_:1})]),_:1},512),f.value.length>0?(r(),x(y,{key:0,class:"px-0 py-1"},{default:t(()=>[e(v,{"no-gutters":""},{default:t(()=>[e(k,{cols:"12"},{default:t(()=>[s("div",Be,[e(b,{color:"grey-lighten-1",variant:"flat",class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",height:"40",onClick:O},{default:t(()=>[...l[5]||(l[5]=[T(" 全部 ",-1)])]),_:1}),e(b,{color:"grey-lighten-1",variant:"flat",class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",height:"40",onClick:O},{default:t(()=>[...l[6]||(l[6]=[T(" 折抵 ",-1)])]),_:1}),e(b,{color:"grey-lighten-1",variant:"flat",class:"my-2 px-8 text-h6 font-weight-regular text-white flex-1-1 flex-md-0-0",height:"40",onClick:O},{default:t(()=>[...l[7]||(l[7]=[T(" 儲值 ",-1)])]),_:1})])]),_:1})]),_:1})]),_:1})):D("",!0),f.value.length>0?(r(),x(F,{key:1,variant:"flat",class:"bg-white flex-grow-1 overflow-y-auto"},{default:t(()=>[e(g,null,{default:t(()=>[(r(!0),z(W,null,Y(f.value,c=>(r(),x(N,{class:"pa-0 border",key:c.id},{default:t(()=>[s("div",Re,[e(v,{"no-gutters":"",class:"align-center flex-grow-1"},{default:t(()=>[e(k,{cols:"4",md:"3"},{default:t(()=>[s("div",je,d(c.plate),1)]),_:2},1024),e(k,{cols:"3",md:"4",class:"pl-2 text-no-wrap"},{default:t(()=>[T(d(c.amount?c.amount:"-")+" 小時 ",1)]),_:2},1024),e(k,{cols:"5",md:"5",class:"pl-2 text-subtitle-1 text-grey-darken-2"},{default:t(()=>[s("div",Ne,[s("div",Fe,d(c.discount_time),1),s("div",Pe,d(c.name)+" "+d(c.account),1)])]),_:2},1024)]),_:2},1024)])]),_:2},1024))),128))]),_:1})]),_:1})):D("",!0)]),_:1})]),_:1}),e(ee,{modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=c=>i.value=c),message:w.value,messageTitle:I.value,isConfirmBtn:S.value,onPromptConfirm:p,onOnClose:A},null,8,["modelValue","message","messageTitle","isConfirmBtn"])])}}},Le={id:"shopView",class:"d-flex flex-column bg-grey-lighten-4 h-100"},Oe={class:"pt-2 d-flex align-center"},Ae={class:"ml-3 text-subtitle-1 font-weight-bold text-grey-darken-3"},Me={__name:"ShopView",setup(E){const H="https://peterhsj.github.io/RentalDemo",R=re(),$=a(null),m=a({}),i=a(!1),I=a(!1),w=a(!1),S=a(""),U=a(""),j=a(!1),h=l=>{m.value=l,i.value=!0,l.value==="logout"&&(localStorage.removeItem("memberInfo"),$.value=null)},V=()=>{m.value={},i.value=!1},f=()=>{m.value={},i.value=!1,R.push("/ShopLogin")},L=()=>{m.value={},i.value=!1},O=()=>{w.value=!1},p=()=>{w.value=!1},A=()=>{I.value=window.innerWidth<=960},u=()=>{if(localStorage.getItem("memberInfo"))$.value=JSON.parse(localStorage.getItem("memberInfo"));else{R.push("/ShopLogin");return}};return te(()=>{u(),A(),window.addEventListener("resize",A)}),oe(()=>{window.removeEventListener("resize",A)}),(l,_)=>{const P=n("v-img"),k=n("v-avatar"),B=n("v-card"),b=n("v-container");return r(),z("div",Le,[se(e(b,{class:"pb-1 rental rental__wrapper"},{default:t(()=>[e(B,{variant:"elevated",elevation:"4",class:"pa-2"},{default:t(()=>[e(P,{color:"surface-variant",height:"200",width:"100%",src:`${M(H)}/images/hotel_01.png`,cover:"",alt:"Shop Image"},{default:t(()=>[..._[1]||(_[1]=[s("h1",{class:"ml-6 mt-4 text-h5 font-weight-bold"},"商店消費停車折抵",-1)])]),_:1},8,["src"]),s("div",Oe,[e(k,{image:`${M(H)}/images/profile.svg`,size:"30"},null,8,["image"]),s("span",Ae,d($.value&&$.value.vendor_name)+" "+d($.value&&$.value.acc_name)+" 您好！ ",1)])]),_:1}),i.value?D("",!0):(r(),x(ie,{key:0,tabList:M(ue),onSetActiveTab:h},null,8,["tabList"]))]),_:1},512),[[ne,!I.value||!i.value]]),m.value.value==="parkingDeduction"?(r(),x(b,{key:0,id:"parkingDeduction",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(Ve,{activeTab:m.value,memberInfo:$.value,onCloseForm:V},null,8,["activeTab","memberInfo"])]),_:1})):D("",!0),m.value.value==="search"?(r(),x(b,{key:1,id:"search",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(ze,{activeTab:m.value,memberInfo:$.value,onCloseForm:V},null,8,["activeTab","memberInfo"])]),_:1})):D("",!0),m.value.value==="logout"?(r(),x(b,{key:2,id:"logout",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(ce,{activeTab:m.value,onOnLogin:f},null,8,["activeTab"])]),_:1})):D("",!0),m.value.value==="changePassword"?(r(),x(b,{key:3,id:"changePassword",class:"rental rental__wrapper flex-grow-1 overflow-y-hidden"},{default:t(()=>[e(de,{activeTab:m.value,userInfo:$.value,onOnClose:L},null,8,["activeTab","userInfo"])]),_:1})):D("",!0),e(ee,{modelValue:w.value,"onUpdate:modelValue":_[0]||(_[0]=q=>w.value=q),message:U.value,messageTitle:S.value,isConfirmBtn:j.value,onPromptConfirm:O,onOnClose:p},null,8,["modelValue","message","messageTitle","isConfirmBtn"])])}}},Ke=fe(Me,[["__scopeId","data-v-794c1189"]]);export{Ke as default};
